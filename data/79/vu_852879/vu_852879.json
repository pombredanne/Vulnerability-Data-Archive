{
  "Author": "This document was written by Garret Wassermann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2014-9293",
    "CVE-2014-9294",
    "CVE-2014-9295",
    "CVE-2014-9296",
    "CVE-2014-9297",
    "CVE-2014-9298"
  ],
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "P",
  "CVSS_BaseScore": 7.5,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "P",
  "CVSS_EnvironmentalScore": 5.86048806962325,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "P",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 5.9,
  "CVSS_TemporalVector": "E:POC/RL:OF/RC:C",
  "DateCreated": "2014-12-03T17:15:19-05:00",
  "DateFirstPublished": "2014-12-19T12:25:19-05:00",
  "DateLastUpdated": "2015-10-26T22:22:00-04:00",
  "DatePublic": "2014-12-19T00:00:00",
  "Description": "The Network Time Protocol (NTP) provides networked systems and devices with a way to synchronize time for various services and applications. The reference implementation produced by the NTP Project (ntp.org) contains several vulnerabilities. CWE-290: Authentication Bypass by Spoofing - CVE-2014-9298 The IPv6 address ::1 can be spoofed, allowing an attacker to bypass ACLs based on ::1. CWE-754: Improper Check for Unusual or Exceptional Conditions - CVE-2014-9297 The length value in extension field pointers is not properly validated, allowing information leaks. CWE-332: Insufficient Entropy in PRNG - CVE-2014-9293 If no authentication key is defined in the ntp.conf file, a cryptographically-weak default key is generated. CWE-338: Use of Cryptographically Weak Pseudo-Random Number Generator (PRNG) - CVE-2014-9294 ntp-keygen before 4.2.7p230 uses a non-cryptographic random number generator with a weak seed to generate symmetric keys. CWE-121: Stack Buffer Overflow - CVE-2014-9295 A remote unauthenticated attacker may craft special packets that trigger buffer overflows in the ntpd functions crypto_recv() (when using autokey authentication), ctl_putdata(), and configure(). The resulting buffer overflows may be exploited to allow arbitrary malicious code to be executed with the privilege of the ntpd process. CWE-389: Error Conditions, Return Values, Status Codes - CVE-2014-9296 A section of code in ntpd handling a rare error is missing a return statement, therefore processing did not stop when the error was encountered. This situation may be exploitable by an attacker. The NTP Project provides more information about these issues in their security advisory. The NTP Project implementation is widely used in operating system distributions and network products. These vulnerabilities affect ntpd acting as a server or client. CERT/CC is not aware of any public exploit of these vulnerabilities at this time. The CVSS score below is based on the buffer overflow vulnerabilities (CVE-2014-9295).",
  "ID": "VU#852879",
  "IDNumber": "852879",
  "IPProtocol": "",
  "Impact": "The buffer overflow vulnerabilities in ntpd may allow a remote unauthenticated attacker to execute arbitrary malicious code with the privilege level of the ntpd process. The weak default key and non-cryptographic random number generator in ntp-keygen may allow an attacker to gain information regarding the integrity checking and authentication encryption schemes. More specifically, the weak default key allows access to private mode and control mode queries that require authentication, if not restricted by the configuration.",
  "Keywords": [
    "NTP",
    "ntpd",
    "buffer overflow",
    "weak key",
    "random number generator"
  ],
  "Overview": "The NTP Project ntpd version 4.2.7 and pervious versions contain several vulnerabilities. ntp-keygen prior to version 4.2.7p230 also uses a non-cryptographic random number generator when generating symmetric keys. These vulnerabilities may affect ntpd acting as a server or client.",
  "References": [
    "http://support.ntp.org/bin/view/Main/SecurityNotice",
    "http://lists.ntp.org/pipermail/announce/2014-December/000122.html",
    "http://support.ntp.org/bin/view/Support/AccessRestrictions#Section_6.5.2",
    "http://www.ntp.org/downloads.html",
    "http://www.ntp.org/ntpfaq/NTP-s-algo-crypt.htm",
    "http://googleprojectzero.blogspot.com/2015/01/finding-and-exploiting-ntpd.html",
    "https://ics-cert.us-cert.gov/advisories/ICSA-14-353-01"
  ],
  "Resolution": "Apply an update These issues have been addressed in ntp-4.2.8p1. The update may be downloaded from ntp.org.",
  "Revision": 124,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "The NTP Project credits Stephen Roettger and Neel Mehta of the Google Security Team for discovering these vulnerabilities.",
  "Title": "NTP Project Network Time Protocol daemon (ntpd) contains multiple vulnerabilities (Updated)",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 9,
  "Workarounds": "Restrict status queries As noted in the announcement for ntp-4.2.8: The vulnerabilities listed below can be significantly mitigated by following the BCP of putting restrict default ... noquery in the ntp.conf file. With the exception of: receive(): missing return on error\n   References: Sec 2670 / CVE-2014-9296 / VU#852879 below (which is a limited-risk vulnerability), none of the recent vulnerabilities listed below can be exploited if the source IP is restricted from sending a 'query'-class packet by your ntp.conf file. Use firewall rules Install firewall rules that block ::1 IPv6 address from inappropriate network interfaces. Disable autokey authentication Disable Autokey Authentication by removing, or commenting out, all configuration directives beginning with the crypto keyword in your ntp.conf file."
}