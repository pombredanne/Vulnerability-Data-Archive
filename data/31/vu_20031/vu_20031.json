{
  "Author": "This document was written by Shawn V Hernan.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1999-01-05T17:40:06-05:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2005-03-08T13:52:00-05:00",
  "DatePublic": "",
  "Description": "From David G. Andersen Security Bulletin\n\nThe K Desktop Environment (KDE) provides an integrated graphical desktop environment for UNIX workstations.  As a part of this environment, it supplies its own PPP implementation (kppp) and its own screen locking environment (klock), both of which are installed setuid root.  Both of these programs have numerous security vulnerabilities which can expose the computer to a root compromise by a local user.\n\nThe general problem is that KDE trusts user supplied environment\nvariables too much.  This trust leads to several problems:\n\nTrust of \".kss.pid\" file contents:\n\n  Arbitrary processes may be killed by klock, because KDE trusts the\n  content of the \".kss.pid\" file, containing the process ID of other\n  running klock processes.  If it finds them, it kills them.  A\n  user can place an arbitrary PID in this file, which klock will\n  kill, as root.\n\n    setenv HOME \"/tmp\"\n    echo thepid > /tmp/.kss.pid\n    klock\n\nA race condition (TTCTTOU flaw) in locating kblankscrn.kss:\n\n    Obviously, the problem found by HD Moore can take advantage of the\n    race condition between the two execlp's that klock calls.  From\n    the KDE code:\n\n                   execlp( buffer, buffer, \"-test\", \"-lock\", 0 );\n                   execlp(\"kblankscrn.kss\",\"kblankscrn.kss\",\"-test\",\"-lock\",0);\n\n    This is less trivially exploitable, but is still serious, and\n    can lead to root compromise.\n\nKDE trusts the value of the KDEDIR environment variable.\n\n   In numerous locations, KDE uses the value returned by kde_bindir\n   to locate its executables.  The value of this is determined by\n   the KDEDIR environment variable.  In the klock case, KDE uses\n   this directory as the initial search path for locating the\n   screensaver to be executed, which it does as root:\n\n   setenv KDEDIR /tmp\n   echo \"#!/bin/sh\" > /tmp/kblankscrn.kss\n   echo \"id\" >> /tmp/blankscrn.kss\n   chmod +x /tmp/blankscrn.kss\n   klock\n\n   This flaw has similar ramifications in kppp.\n\nkppp trusts the value of the HOME environment variable:\n\n    When kppp starts up, it attempts to create a set of nested\n    directories to contain logfiles and configuration files.\n    To locate these files, it uses the value of the HOME\n    environment variable, and the make_directories function\n    uses this to create a \".kde\" directory as root.  Within\n    this directory, it creates several subdirectories which\n    are owned by the user.  The result is that a user can create\n    a \".kde\" directory in an arbitrary location (potentially\n    overwriting another user's .kde directory), with writable\n    scratch space contained within.\n\nkppp fails to check the length of the PATH environment variable\nwhen copying its contents into a static buffer:\n\n  if(getenv(\"PATH\") != NULL)\n    strncat(path, getenv(\"PATH\"), sizeof(path)-512);",
  "ID": "VU#20031",
  "IDNumber": "20031",
  "IPProtocol": "",
  "Impact": "Local users may obtain root priviledges, kill local processes, or create hidden directories on any local filesystem.",
  "Keywords": [
    "KDE",
    "kppp",
    "klock",
    "FreeBSD",
    "kblankscrn.kss"
  ],
  "Overview": "",
  "References": "http://www.geek-girl.com/bugtraq/1998_4/0478.html",
  "Resolution": "",
  "Revision": 2,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "Multiple vulnerabilities in KDE kpp and klock programs",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}