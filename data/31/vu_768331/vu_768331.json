{
  "Author": "This document was written by Trent Novelly.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2016-9485",
    "CVE-2016-9486"
  ],
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "L",
  "CVSS_Authenication": "S",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 6.6,
  "CVSS_BaseVector": "AV:L/AC:M/Au:S/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "N",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 4.4289721728,
  "CVSS_EnvironmentalVector": "CDP:N/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "ND",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 5.9,
  "CVSS_TemporalVector": "E:POC/RL:ND/RC:C",
  "DateCreated": "2016-11-07T09:59:52-05:00",
  "DateFirstPublished": "2016-12-07T17:17:56-05:00",
  "DateLastUpdated": "2017-02-06T10:56:00-05:00",
  "DatePublic": "2016-12-07T00:00:00",
  "Description": "On Windows endpoints, the SecureConnector agent must run under the local SYSTEM account or another administrator account in order to enable full functionality of the agent. The typical configuration is for the agent to run as a Windows service under the local SYSTEM account. The SecureConnector agent runs various plugin scripts and executables on the endpoint in order to gather and report information about the host to the CounterACT management appliance. The SecureConnector agent downloads these scripts and executables as needed from the CounterACT management appliance and runs them on the endpoint. CWE-378: Creation of Temporary File with Insecure Permissions - CVE-2016-9485 \nThe SecureConnector agent fails to set any permissions on downloaded file objects. This allows a malicious user to take ownership of any of these files and make modifications to it, regardless of where the files are saved. These files are then executed under SYSTEM privileges. A malicious unprivileged user can overwrite these executable files with malicious code before the SecureConnector agent executes them, causing the malicious code to be run under the SYSTEM account. CWE-379: Creation of Temporary File in Directory with Incorrect Permissions - CVE-2016-9486 \nBy default, these executable files are downloaded to and run from the %TEMP% directory of the currently logged on user, despite the fact that the SecureConnector agent is running as SYSTEM. Aside from the downloaded scripts, the SecureConnector agent runs a batch file with SYSTEM privileges from the temp directory of the currently logged on user. If the naming convention of this script can be derived, which is made possible by placing it in a directory to which the user has read access, it may be possible overwrite the legitimate batch file with a malicious one before SecureConnector executes it. It is possible to change this directory by setting the the configuration property config.script_run_folder.value in the local.properties configuration file on the CounterACT management appliance, however the batch file which is run does not follow this property. The CVSS score below represents CVE-2016-9485.",
  "ID": "VU#768331",
  "IDNumber": "768331",
  "IPProtocol": "",
  "Impact": "A local unprivileged attacker may gain SYSTEM privileges on an affected machine.",
  "Keywords": [
    "privilege escalation",
    "CWE-378",
    "Windows"
  ],
  "Overview": "On Windows endpoints, the SecureConnector agent is vulnerable to privilege escalation whereby an authenticated unprivileged user can obtain administrator privileges on the endpoint by causing the SecureConnector agent to execute arbitrary code.",
  "References": [
    "https://www.forescout.com/products/counteract/",
    "https://cwe.mitre.org/data/definitions/378.html",
    "https://cwe.mitre.org/data/definitions/379.html"
  ],
  "Resolution": "Apply an update\nThe vendor has released the HPS Inspection Engine Plugin, version 10.4.1.1 to address the vulnerability.",
  "Revision": 9,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Brendan Saulsbury, Ariel Montano Cardenas, and Matthew Hyde for reporting this vulnerability.",
  "Title": "ForeScout CounterACT SecureConnector agent is vulnerable to privilege escalation",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "2",
  "VRDA_D1_Population": "2",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}