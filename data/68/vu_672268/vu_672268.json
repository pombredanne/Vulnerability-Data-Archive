{
  "Author": "This document was written by Garret Wassermann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "S",
  "CVSS_AvailabilityImpact": "N",
  "CVSS_BaseScore": 6.3,
  "CVSS_BaseVector": "AV:N/AC:M/Au:S/C:C/I:N/A:N",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 5.6836455144,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "N",
  "CVSS_RemediationLevel": "W",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 5.7,
  "CVSS_TemporalVector": "E:F/RL:W/RC:C",
  "DateCreated": "2015-03-02T06:46:43-05:00",
  "DateFirstPublished": "2015-04-13T10:00:55-04:00",
  "DateLastUpdated": "2017-09-05T17:58:00-04:00",
  "DatePublic": "2015-04-13T00:00:00",
  "Description": "CWE-201: Information Exposure Through Sent Data Many software products use HTTP requests for various features such as software update checking. A malicious user can intercept such requests (such as with a MITM proxy) and use HTTP Redirect to redirect the victim a malicious SMB server. If the redirect is a file:// URL and the victim is running Microsoft Windows, Windows will automatically attempt to authenticate to the malicious SMB server by providing the victim's user credentials to the server. These credentials can then be logged by the malicious server. The credentials are encrypted, but may be \"brute-forced\" to break the encryption. The following Windows API functions (available via urlmon.dll) have been identified as being affected: URLDownloadA\nURLDownloadW\nURLDownloadToCacheFileA\nURLDownloadToCacheFileW\nURLDownloadToFileA\nURLDownloadToFileW\nURLOpenStream\nURLOpenBlockingStream urlmon uses the wininet library for processing, therefore the affected functionality may be contained within wininet; it is currently not clear where the vulnerability lies. Internet Explorer and the WebBrowser component of .NET have also be reported vulnerable to this SMB redirection. For a longer description with more examples, see Cylance's blog on the issue. While the HTTP Redirect vector is novel, this type of issue with SMB has been well known for some time. For example, see Aaron Spangler's report from 1997, Steve Birnbaum's report, Paul Ashton's report, and information from Microsoft from 2009. Please see the full list of references at the end of this publication.",
  "ID": "VU#672268",
  "IDNumber": "672268",
  "IPProtocol": "",
  "Impact": "An attacker exploiting this vulnerability may obtain the victim's user credentials in an encrypted format.",
  "Keywords": "",
  "Overview": "Software running on Microsoft Windows that utilizes HTTP requests can be forwarded to a file:// protocol on a malicious server, which causes Windows to automatically attempt authentication via SMB to the malicious server in some circumstances. The encrypted form of the user's credentials are then logged on the malicious server. This vulnerability is alternatively known as \"Redirect to SMB\".",
  "References": [
    "http://blog.cylance.com/redirect-to-smb",
    "https://technet.microsoft.com/en-us/library/security/974926.aspx",
    "https://technet.microsoft.com/en-us/library/security/973811.aspx",
    "https://technet.microsoft.com/en-us/library/jj865668(v=ws.10).aspx",
    "https://technet.microsoft.com/en-us/library/jj865676(v=ws.10).aspx",
    "http://blogs.technet.com/b/askds/archive/2009/10/08/ntlm-blocking-and-you-application-analysis-and-auditing-methodologies-in-windows-7.aspx",
    "https://msdn.microsoft.com/en-us/library/ms775122%28v=vs.85%29.aspx",
    "https://msdn.microsoft.com/en-us/library/ms775123%28v=vs.85%29.aspx",
    "https://msdn.microsoft.com/en-us/library/aa939357%28v=WinEmbedded.5%29.aspx",
    "https://msdn.microsoft.com/en-us/library/windows/desktop/aa385483%28v=vs.85%29.aspx",
    "https://technet.microsoft.com/library/jj852213(v=ws.10).aspx",
    "http://insecure.org/sploits/winnt.automatic.authentication.html",
    "http://insecure.org/sploits/win95.smb.auto-auth.html",
    "http://insecure.org/sploits/NT.NTLM.auto-authentication.html",
    "http://cwe.mitre.org/data/definitions/201.html"
  ],
  "Resolution": "The CERT/CC is currently unaware of a full solution to this problem. However, affected users may consider the following workarounds.",
  "Revision": 67,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Brian Wallace of Cylance, Inc., for reporting this vulnerability.",
  "Title": "Microsoft Windows NTLM automatically authenticates via SMB when following a file:// URL",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Block outbound SMB Consider blocking outbound SMB connections (TCP ports 139 and 445) from the local network to the WAN. Update NTLM group policy This attack may be mitigated in some circumstances by restricting NTLM via appropriate Group Policy. See reference one and reference two from Microsoft. Do not use NTLM for authentication by default in applications Developers should ensure their software complies with appropriate Group Policy and does not use NTLM for authentication by default. Use a strong password and change passwords frequently Since the credentials are provided to the attacker in encrypted form, a stronger password may require more time to break the encryption. Changing passwords regularly further deters brute-force attacks against the encryption."
}