{
  "Author": "This document was written by Robert D Hanson.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "--",
  "CVSS_AccessVector": "--",
  "CVSS_Authenication": "--",
  "CVSS_AvailabilityImpact": "--",
  "CVSS_BaseScore": 0,
  "CVSS_BaseVector": "AV:--/AC:--/Au:--/C:--/I:--/A:--",
  "CVSS_CollateralDamagePotential": "Not Defined (ND)",
  "CVSS_ConfidentialityImpact": "--",
  "CVSS_EnvironmentalScore": 0,
  "CVSS_EnvironmentalVector": "CDP:Not Defined (ND)/TD:Not Defined (ND)/CR:Not Defined (ND)/IR:Not Defined (ND)/AR:Not Defined (ND)",
  "CVSS_Exploitability": "Not Defined (ND)",
  "CVSS_IntegrityImpact": "--",
  "CVSS_RemediationLevel": "Not Defined (ND)",
  "CVSS_ReportConfidence": "Not Defined (ND)",
  "CVSS_SecurityRequirementsAR": "Not Defined (ND)",
  "CVSS_SecurityRequirementsCR": "Not Defined (ND)",
  "CVSS_SecurityRequirementsIR": "Not Defined (ND)",
  "CVSS_TargetDistribution": "Not Defined (ND)",
  "CVSS_TemporalScore": 0,
  "CVSS_TemporalVector": "E:Not Defined (ND)/RL:Not Defined (ND)/RC:Not Defined (ND)",
  "DateCreated": "2004-12-13T11:08:12-05:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2004-12-13T11:11:00-05:00",
  "DatePublic": "",
  "Description": "",
  "ID": "VU#784969",
  "IDNumber": "784969",
  "IPProtocol": "",
  "Impact": "The complete impact of this vulnerability is not yet known.",
  "Keywords": [
    "iptables",
    "dcc",
    "chat"
  ],
  "Overview": "I have found a way to connect illegally to any TCP port on an FTP server \nthat IPTables protects by deceiving connection-tracking. In most cases, IPTables administrators make stateful packet filtering rule(s)\nin order to accept Internet services such as IRC chat and FTP data transfer connection. To do this, the administrators usually insert the following rule into the IPTables rule list. iptables -A FORWARD -m state --state ESTABLISHED, RELATED -j ACCEPT And they load the connection-tracking modules including the module ip_conntrack_ftp \nand ip_conntrack_irc into the firewall. Suppose that a malicious user who logged on the FTP server transmits a PORT command \nwith TCP port number 6667(this is a default IRC server port no.) on the external network\n and then attempts to download a file from the server. The FTP server initiates the FTP data transfer connection to port 6667 on the attacker's host. The firewall accepts this connection under the stateful packet filtering rule stated before. Once the connection is established, the module ip_conntrack has the security flaw \nto mistake this for an IRC connection. The attacker's host can pretend to be an IRC server. If the attacker downloads a file comprised of a string that has the same pattern \nas DCC CHAT command, the module ip_conntrack_irc will misunderstand contents of a packet\n for the FTP data transfer as a DCC CHAT command. In result, The firewall allows any host to connect to the TCP port number\n,which is specified in the fake DCC CHAT command, on the fake IRC client(i.e. the FTP server) \naccording to the rule to accept the \"related\" connection for IRC. For this, the attacker has to upload \nthe file before the intrusion. In conclusion, the attacker is able to illegally connect to any TCP port on the FTP server.",
  "References": "",
  "Resolution": "The CERT/CC is currently unaware of a practical solution to this problem.",
  "Revision": 1,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "Vulnerability in IPTABLES allows access to any port via fake DCC CHAT command",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}