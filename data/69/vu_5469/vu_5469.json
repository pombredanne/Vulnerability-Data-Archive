{
  "Author": "This document was written by new-vul.",
  "CAM_AttackerAccessRequired": "10",
  "CAM_EaseOfExploitation": "15",
  "CAM_Exploitation": "10",
  "CAM_Impact": "3",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "20",
  "CAM_ScoreCurrent": 1.85625,
  "CAM_ScoreCurrentWidelyKnown": 5.0625,
  "CAM_ScoreCurrentWidelyKnownExploited": 6.75,
  "CAM_WidelyKnown": "1",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:51:34-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "1999-02-15T09:34:59-05:00",
  "DatePublic": "",
  "Description": "The /usr/bin/passwd program replaces the local shadow password\ndatabase, i.e., /etc/shadow, by the new one as following.\n\nunlink(\"/etc/oshadow\")\nrename(\"/etc/shadow\", \"/etc/oshadow\")\nrename(\"/etc/stmp\", \"/etc/shadow\")\n\nThis provides a way to remove the /etc/shadow file to any local\nuser who is registered in the local password database by sending a\nSIGKILL signal between the two rename commands.  In this way, the\n(backup) oshadow file no longer exists, and the new copy hasn't\nbeen put in place.",
  "ID": "VU#5469",
  "IDNumber": "5469",
  "IPProtocol": "",
  "Impact": "A denial of service attack may occur in which no users can log in\nsince the shadow password file no longer exists.",
  "Keywords": "",
  "Overview": "",
  "References": "",
  "Resolution": "",
  "Revision": "1",
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "shadow_password_DoS",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": "The passwd program should replace /etc/shadow by: unlink(\"/etc/oshadow\")\nlink(\"/etc/shadow\", \"/etc/oshadow\")\nrename(\"/etc/stmp\", \"/etc/shadow\") Preferably, it should also protect itself from signals sent from\nthe user and the control terminal, for example: pid = fork(); if (pid > 0) {\nsetrlimit(RLIMIT_CORE, ...); /* prevent unexpected core dump */\nsetuid((uid_t)0); /* protect myself from signals from the user */\nsetsid(); /* release the control terminal */\n... lock the database ... unlink(\"/etc/oshadow\")\nlink(\"/etc/shadow\", \"/etc/oshadow\")\nrename(\"/etc/stmp\", \"/etc/shadow\")\n... unlock the database ... exit(0); ... wait for the child ..."
}