{
  "Author": "This document was written by Jared Allar.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "P",
  "CVSS_BaseScore": 9.7,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:C/I:C/A:P",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 6.5,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "U",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 8.7,
  "CVSS_TemporalVector": "E:POC/RL:U/RC:C",
  "DateCreated": "2012-10-08T09:04:16-04:00",
  "DateFirstPublished": "2012-11-05T15:16:45-05:00",
  "DateLastUpdated": "2012-11-06T12:47:00-05:00",
  "DatePublic": "2012-11-05T00:00:00",
  "Description": "Sophos Antivirus contains multiple vulnerabilities including memory corruption issues and design flaws. Tavis Ormandy's security report lists the following vulnerabilities. These vulnerabilities are new and separate from Tavis' 2011 report entitled \"Sophail: A Critical Analysis of Sophos Antivirus.\" [PDF]  Additional details are available in Tavis Ormandy's full report entitled, \"Sophail: Applied attacks against Sophos Antivirus.\" [PDF]  A response from Sophos has been posted to their blog: \"Sophos products and Tavis Ormandy.\" Integer overflow parsing Visual Basic 6 controls\nVisual Basic 6 executables include metadata for GUIDs, Names, Paths, etc. Sophos Antivirus extracts some of this metadata when it finds a VB6 executable. The validation code for this metadata is inconsistent so there exists an integer overflow vulnerability that may lead to a heap overflow exploit. sophos_detoured_x64.dll ASLR bypass\nSophos Antivirus comes with a buffer overrun protection feature called \"BOPS.\" This feature is meant to provide an ASLR-like implementation for Windows XP. The feature is implemented by using AppInit_DLLs to force most processes to load sophos_detoured_x64.dll. This DLL file does not support ASLR, which results in the DLL file being loaded at a static address. This DLL can then be used in return-oriented programming exploits to bypass ASLR on Windows Vista and Windows 7. Internet Explorer protected mode is effectively disabled by Sophos\nSophos Antivirus installs a Layered Service Provider (LSP) into Internet Explorer that loads DLL files from low integrity writable directories. This feature results in effectively disabling Internet Explorer's protected mode. Universal XSS\nThe template for the LSP block page contains a Universal XSS vulnerability. A Universal XSS vulnerability effectively disables the \"Same Origin Policy\" in a web browser that results in a malicious website being able to interact with web browser data across web sites. Memory corruption vulnerability in Microsoft CAB parsers\nThe SARCcabSTart() function allocates a fixed-size 32768 byte buffer to store the contents of CFDATA structures. The CFDATA structure is a 16-bit size field that can hold 2^16 - 1 bytes but the fixed buffer size is only 2^15. Vulnerabilities that result in memory corruption controlled by an attacker are exploitable. RAR virtual machine standard filters memory corruption\nRAR decompression includes a bytecode interpreting VM. The VM_STANDARD opcode takes a filter as an operand. Sophos Antivirus does not correctly handle these filters causing memory corruption. Privilege escalation through network update service\nSophos Antivirus includes a network update service that runs with NT AUTHORITY\\SYSTEM privileges. The service loads modules from a directory that is world-writable. A specifically crafted DLL file can be placed in the world-writable directory and it will be loaded by the update service with SYSTEM privileges. Stack buffer overflow decrypting PDF files\nSophos Antivirus attempts to parse encrypted revision 3 PDF files by reading the encryption key contents onto a fixed length stack buffer of 5 bytes. A specifically crafted PDF file with the Length attribute greater than 5*8 will cause a buffer overflow.",
  "ID": "VU#662243",
  "IDNumber": "662243",
  "IPProtocol": "",
  "Impact": "An attacker may be able to gain control of the system, escalate privileges, or cause a denial-of-service condition.",
  "Keywords": [
    "sophos",
    "antivirus",
    "aslr",
    "rar",
    "cab",
    "overflow"
  ],
  "Overview": "Sophos Antivirus contains multiple vulnerabilities including memory corruption issues and design flaws.",
  "References": [
    "https://lock.cmpxchg8b.com/sophailv2.pdf",
    "http://nakedsecurity.sophos.com/2012/11/05/tavis-ormandy-sophos/",
    "http://lists.grok.org.uk/pipermail/full-disclosure/2012-November/088813.html"
  ],
  "Resolution": "Apply an Update Sophos has released patches to address these vulnerabilities. Sophos customers should acquire the patches through their usual support channels.",
  "Revision": 40,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Tavis Ormandy for reporting this vulnerability.",
  "Title": "Sophos Antivirus contains multiple vulnerabilities",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}