{
  "Author": "This document was written by Art Manion based on information from MS12-020 and ZDI-12-044.",
  "CAM_AttackerAccessRequired": "12",
  "CAM_EaseOfExploitation": "7",
  "CAM_Exploitation": "6",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "5",
  "CAM_Population": "15",
  "CAM_ScoreCurrent": 12.285,
  "CAM_ScoreCurrentWidelyKnown": 14.6475,
  "CAM_ScoreCurrentWidelyKnownExploited": 21.2625,
  "CAM_WidelyKnown": "15",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2012-0002",
    "CVE-2012-0152"
  ],
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 10,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 5.86926702432,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 7.8,
  "CVSS_TemporalVector": "E:POC/RL:OF/RC:C",
  "DateCreated": "2012-03-08T13:55:48-05:00",
  "DateFirstPublished": "2012-03-15T23:48:07-04:00",
  "DateLastUpdated": "2015-09-17T16:39:00-04:00",
  "DatePublic": "2012-03-13T00:00:00",
  "Description": "The Microsoft Remote Desktop Protocol (RDP) provides a remote graphical interface to Microsoft Windows systems. Microsoft Security Bulletin MS12-020 describes a remote code execution vulnerability in the RDP service. TippingPoint Zero Day Initiative advisory ZDI-12-044 indicates the vulnerability is caused by a double-free condition that occurs when RDP handles an error and aborts a connection. MS12-020 also describes a denial-of-service vulnerability (CVE-2012-0152).",
  "ID": "VU#624051",
  "IDNumber": "624051",
  "IPProtocol": "tcp",
  "Impact": "A remote, unauthenticated attacker could execute arbitrary code with the privileges of the RDP driver, effectively taking complete control of a vulnerable system.",
  "Keywords": [
    "MS12-020",
    "ZDI-12-044",
    "double-free",
    "CWE-415",
    "MEM31-C",
    "2671387"
  ],
  "Overview": "The Microsoft Remote Desktop Protocol (RDP) service contains a double-free vulnerability that could allow a remote, unauthenticated attacker to execute arbitrary code on a vulnerable system.",
  "References": [
    "http://technet.microsoft.com/en-us/security/bulletin/ms12-020",
    "http://aluigi.org/adv/termdd_1-adv.txt",
    "http://www.zerodayinitiative.com/advisories/ZDI-12-044/",
    "http://blogs.technet.com/b/srd/archive/2012/03/13/cve-2012-0002-a-closer-look-at-ms12-020-s-critical-issue.aspx",
    "http://msdn.microsoft.com/en-us/library/aa383015(v=VS.85).aspx",
    "http://technet.microsoft.com/en-us/library/cc732713.aspx",
    "http://support.microsoft.com/kb/315055",
    "http://support.microsoft.com/kb/816521",
    "http://support.microsoft.com/kb/306759",
    "https://www.securecoding.cert.org/confluence/display/seccode/MEM31-C.+Free+dynamically+allocated+memory+exactly+once",
    "http://cwe.mitre.org/data/definitions/415.html",
    "http://aluigi.org/adv/ms12-020_leak.txt"
  ],
  "Resolution": "Apply an update Apply the appropriate updates as described in MS12-020.",
  "Revision": 25,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Microsoft credits Luigi Auriemma, via TippingPoint's Zero Day Initiative.",
  "Title": "Microsoft Remote Desktop Protocol (RDP) insecurely deallocates memory",
  "US-CERTTechnicalAlert": "TA12-073A",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 2,
  "Workarounds": "Enable Network Level Authentication (NLA) NLA requires authentication before a remote desktop session is created. This means an attacker would have to successfully authenticate before exploiting the double-free vulnerability. Note that Windows Server 2003 does not support NLA cannot connect to a Remote Desktop service that requires NLA. For more information, see Configure Network Level Authentication for Remote Desktop Services Connections. Authenticate RDP connections using independent protocols Use other secure network protocols to authenticate users before allowing RDP connections. Microsoft provides KB articles that describe how to use IPsec to secure RDP connections on Windows 2000 and Windows Server 2003. Many types of VPN can be used to authenticate users, and RDP traffic can be tunneled over SSH if an SSH daemon is installed on the RDP server. Change RDP listening port Changing the listening port used by RDP (3389/tcp) will not protect against attacks, but may hide RDP servers from scanning that targets the default port. See How to change the listening port for Remote Desktop. Restrict access Restrict RDP server access to trusted hosts and networks."
}