{
  "Addendum": "We have no additional comments at this time.",
  "DateLastUpdated": "2005-07-12T16:17:00-04:00",
  "DateNotified": "",
  "DateResponded": "",
  "ID": "VU#623332",
  "Revision": 1,
  "Status": "Vulnerable",
  "Vendor": "MiT Kerberos Development Team",
  "VendorInformation": "We are not aware of further vendor information regarding this vulnerability.",
  "VendorRecordID": "RMED-6E8RR7",
  "VendorReferences": "",
  "VendorStatement": "-----BEGIN PGP SIGNED MESSAGE----- MIT krb5 Security Advisory 2005-003 Original release: 2005-07-12 Topic: double-free in krb5_recvauth Severity: CRITICAL SUMMARY The krb5_recvauth() function can free previously freed memory under\nsome error conditions. This vulnerability may allow an\nunauthenticated remote attacker to execute arbitrary code. Exploitation of this vulnerability on a Kerberos Key Distribution\nCenter (KDC) host can result in compromise of an entire Kerberos\nrealm. No exploit code is known to exist at this time. Exploitation\nof double-free vulnerabilities is believed to be difficult. [CAN-2005-1689, VU#623332] IMPACT An unauthenticated attacker may be able to execute arbitrary code in\nthe context of a program calling krb5_recvauth(). This includes the\nkpropd program which typically runs on slave Key Distribution Center\n(KDC) hosts, potentially leading to compromise of an entire Kerberos\nrealm. Other vulnerable programs which call krb5_recvauth() are\nusually remote login programs running with root privileges. Unsuccessful attempts at exploitation may result in denial of service\nby crashing the target program. AFFECTED SOFTWARE * The kpropd daemon in all releases of MIT krb5, up to and including\n  krb5-1.4.1, is vulnerable. * The klogind and krshd remote-login daemons in all releases of MIT\n  krb5, up to and including krb5-1.4.1, is vulnerable. * Third-party application programs which call krb5-recvauth() are also\n  vulnerable. FIXES * The upcoming krb5-1.4.2 release will have a fix for this\n  vulnerability. * Apply the following patch. This patch was generated against the\n  krb5-1.4.1 release. It may apply, with some offset, to earlier\n  releases. The patch may also be found at: http://web.mit.edu/kerberos/advisories/2005-003-patch_1.4.1.txt The associated detached PGP signature is at: http://web.mit.edu/kerberos/advisories/2005-003-patch_1.4.1.txt.asc Index: lib/krb5/krb/recvauth.c RCS file: /cvs/krbdev/krb5/src/lib/krb5/krb/recvauth.c,v\nretrieving revision 5.38\ndiff -c -r5.38 recvauth.c\n*** lib/krb5/krb/recvauth.c\t\t 3 Sep 2002 01:13:47 -0000\t\t 5.38\n- --- lib/krb5/krb/recvauth.c\t\t 23 May 2005 23:19:15 -0000 *** 76,82 ****\n  \t\t     if ((retval = krb5_read_message(context, fd, &inbuf)))\n  \t\t \t\t return(retval); if (strcmp(inbuf.data, sendauth_version)) {\n- - \t\t \t\t krb5_xfree(inbuf.data); problem = KRB5_SENDAUTH_BADAUTHVERS; krb5_xfree(inbuf.data); - --- 76,81 ---- *** 90,96 ****\n  \t\t if ((retval = krb5_read_message(context, fd, &inbuf)))\n  \t\t \t\t return(retval); if (appl_version && strcmp(inbuf.data, appl_version)) {\n- - \t\t \t\t krb5_xfree(inbuf.data); if (!problem)\n  \t\t \t\t \t\t problem = KRB5_SENDAUTH_BADAPPLVERS; - --- 89,94 ---- REFERENCES This announcement and related security advisories may be found on the\nMIT Kerberos security advisory page at: http://web.mit.edu/kerberos/advisories/index.html The main MIT Kerberos web page is at: http://web.mit.edu/kerberos/index.html CVE: CAN-2005-1689\nhttp://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2005-1689 CERT: VU#623332\nhttp://www.kb.cert.org/vuls/id/623332 ACKNOWLEDGMENTS Thanks to Magnus Hagander for reporting this vulnerability. DETAILS The helper function revcauth_common() in lib/krb5/krb/recvauth.c has\ntwo locations which call krb5_read_message(), followed by an\nunconditional krb5_xfree() of the buffer allocated by\nkrb5_read_message(). In the cases where the sendauth version string\nor the application version string do not match the expected value,\nrecvauth_common() performs a krb5_xfree() on the buffer allocated by\nkrb5_read_message() preceding the subsequent unconditional call to\nkrb5_xfree() on the same buffer. Since the code paths which call krb5_xfree() twice do so with almost\nno intervening code, exploitation of this vulnerability may be more\ndifficult than exploitation of other double-free vulnerabilities. No\ndetailed analysis has been performed on the ease of exploitation. REVISION HISTORY 2005-05-12      original release Copyright (C) 2005 Massachusetts Institute of Technology\n-----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.2.5 (SunOS) iQCVAwUBQtMbD6bDgE/zdoE9AQGmhQP+MYnmuw4+J3yIcQbS3chjZXVLHebTJJtN\njM5+cMBDQfYdpuoQER1Bbaf+7Ky1BoyX2zHfANzdDAiSFRykbFqEqgvdw9jqEFmx\nela1UtOhV5H80BZAzmGV+dVIqGPpWH0f4ArRe18Pbz2wZE0Vadq9VkBTJwHI23En\nK3a9oiHA/XM=\n=ZS63\n-----END PGP SIGNATURE-----"
}