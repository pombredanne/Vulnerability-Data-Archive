{
  "Author": "This document was written by Michael Orlando.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2013-5211",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 7.8,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:N/I:N/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "N",
  "CVSS_EnvironmentalScore": 4.57255757448,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "N",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 6.1,
  "CVSS_TemporalVector": "E:POC/RL:OF/RC:C",
  "DateCreated": "2013-09-11T09:03:17-04:00",
  "DateFirstPublished": "2014-01-10T13:00:22-05:00",
  "DateLastUpdated": "2014-08-26T11:00:00-04:00",
  "DatePublic": "2014-01-02T00:00:00",
  "Description": "NTP and other UDP-based protocols can be used to amplify denial-of-service attacks. Servers running the network time protocol (NTP) based on implementations of ntpd prior to version 4.2.7p26 that use the default unrestricted query configuration are susceptible to a reflected denial-of-service (DRDoS) attack. Other proprietary NTP implementations may also be affected. This is similar in scope to DNS Amplification Attacks. In a reflected denial-of-service attack, the attacker spoofs the source address of attack traffic, replacing the source address with the target's address. Certain NTP control messages provide significant bandwidth amplification factors (BAF). NTP is designed for time synchronization, and may also implement other features such as server administration, maintenance, and monitoring. NTP relies on the user datagram protocol (UDP) to send and receive messages, which does not validate the source (IP address) of the sender. The NTP DRDoS attack is similar to the reflective DoS attacks used on open DNS resolvers. The attacker sends a packet with their source address being the IP of a victim. The NTP server replies to this request, but the number of bytes sent in the response is an amplified amount compared to the initial request, resulting in a denial-of-service on the victim. The two highest message types, REQ_MON_GETLIST and REQ_MON_GETLIST_1 amplify the original request by a factor of up to 3660 and 5500 respectively. This bandwidth amplification factor (BAF) is a bandwidth multiplier based on the number of UDP payload bytes that are sent by the server in comparison to the UDP payload bytes of the request. Other message types can also be used in this attack, but REQ_MON_GETLIST and REQ_MON_GETLIST_1 create the biggest impact. This vulnerability contains elements of CWE-406: Insufficient Control of Network Message Volume (Network Amplification). More information can be found in Christian Rossow's \"Amplification DDoS Attacks (Ab)using NTP Servers\" blog post. In April 2014, Rapid7 published R7-2014-12 documenting additional NTP commands that can amplify traffic and disclose potentially sensitive information.",
  "ID": "VU#348126",
  "IDNumber": "348126",
  "IPProtocol": "udp",
  "Impact": "An unauthenticated remote attacker may leverage the vulnerable NTP server to conduct a distributed reflective denial-of-service (DRDoS) attack on another user.",
  "Keywords": [
    "NTP",
    "ntpd",
    "UDP",
    "amplification attack",
    "network time protocol",
    "DRDoS",
    "DoS",
    "denial-of-service",
    "CWE-406",
    "DDoS"
  ],
  "Overview": "UDP protocols such as NTP can be abused to amplify denial-of-service attack traffic. Servers running the network time protocol (NTP) based on implementations of ntpd prior to version 4.2.7p26 that use the default unrestricted query configuration are susceptible to a reflected denial-of-service (DRDoS) attack. Other proprietary NTP implementations may also be affected.",
  "References": [
    "http://bugs.ntp.org/show_bug.cgi?id=1532",
    "http://cwe.mitre.org/data/definitions/406.html",
    "http://www.nwtime.org/",
    "http://ntp.org",
    "http://www.cisco.com/en/US/products/ps9494/Products_Sub_Category_Home.html",
    "http://www.us-cert.gov/ncas/alerts/TA13-088A",
    "http://www.prolexic.com/knowledge-center-white-paper-series-snmp-ntp-chargen-reflection-attacks-drdos-ddos.html",
    "http://www.meinbergglobal.com/english/news/meinberg-security-advisory-mbgsa-1401-ntp-monlist-network-traffic-amplification-attacks.htm",
    "http://christian-rossow.de/articles/Amplification_DDoS.php",
    "https://community.rapid7.com/community/metasploit/blog/2014/08/25/r7-2014-12-more-amplification-vulnerabilities-in-ntp-allow-even-more-drdos-attacks"
  ],
  "Resolution": "Apply an Update\nAffected users are advised to update to ntpd versions 4.2.7p26 and greater. ntpd version 4.2.7p26 disables REQ_MON_GETLIST and REQ_MON_GETLIST_1, removing the two most significant BAF control messages. The 4.2.6.x and earlier production branches are still vulnerable to this attack, however. If an update is not possible, please consider one or more of the following workarounds.",
  "Revision": 83,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Christian Rossow for reporting this vulnerability.",
  "Title": "NTP can be abused to amplify denial-of-service attack traffic",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 1,
  "Workarounds": "Check if the amplified responses are enabled\nEntering the following commands can help users verify if the REQ_MON_GETLIST and REQ_MON_GETLIST_1 responses of NTP are currently enabled: ntpq -c rv\nntpdc -c sysinfo\nntpdc -n -c monlist These commands only verify if the specified functions are enabled. If they are enabled, implement at least one of the following: Perform Egress Filtering\nConfigure your router/firewall to perform egress filtering, which may help to mitigate attacks that utilize source IP spoofing. Please refer to your product's documentation for instructions on how to perform egress filtering. Disable status queries or restrict access. The ntpd status query features provided by ntpq/ntpdc will reveal some information about the system running ntpd (e.g. OS version,  ntpd version) that you may not wish others to know. Disabling this feature may also help to reduce the likelihood of this vulnerability taking place. If the NTP implementation is vulnerable, adding the following lines to your ntp.conf file will restrict informational queries to authorized recipients only. IPV4: restrict default kod nomodify notrap nopeer noquery\nIPv6: restrict -6 default kod nomodify notrap nopeer noquery\nPlease note that a restart of the ntpd service is required for changes to take effect. It is also possible to restrict access per network segment (be sure to modify line 3 to match your LAN settings) and per host (line 4): restrict default noquery\nrestrict localhost\nrestrict 192.168.0.0 netmask 255.255.0.0\nrestrict 192.168.1.27\nPlease note that a restart of the ntpd service is required for changes to take effect. Please also note that the ntpq/ntpdc query capabilities provide useful Q/A and debugging information. Disabling these queries comes with a cost."
}