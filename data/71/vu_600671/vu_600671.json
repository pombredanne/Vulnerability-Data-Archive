{
  "Author": "This document was written by Garret Wassermann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2017-3196",
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "L",
  "CVSS_Authenication": "S",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 6.6,
  "CVSS_BaseVector": "AV:L/AC:M/Au:S/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 4.20752356416,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "U",
  "CVSS_ReportConfidence": "UR",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 5.6,
  "CVSS_TemporalVector": "E:POC/RL:U/RC:UR",
  "DateCreated": "2017-03-17T10:48:52-04:00",
  "DateFirstPublished": "2017-03-21T16:20:32-04:00",
  "DateLastUpdated": "2017-04-21T00:50:00-04:00",
  "DatePublic": "2017-03-15T00:00:00",
  "Description": "The Rawether framework for Windows, originally produced by Printing Communications Assoc., Inc. (PCAUSA) , is a framework that facilitates communication between an application and the Network Driver Interface System (NDIS) protocol. This framework is used by many different hardware vendors in their WiFi and router control applications. Rawether implements the Berkeley Packet Filter (BPF) mechanism. BPF filters are compiled into small programs that are executed by a BPF virtual machine. CWE-119: Improper Restriction of Operations within the Bounds of a Memory Buffer - CVE-2017-3196 The Rawether framework does not properly validate BPF programs before execution, allowing BPF programs that may read/write arbitrary memory or infinitely loop. The return address on the stack may be overwritten, allowing a local user to execute arbitrary code with SYSTEM privileges. To enable the vulnerable part of the driver, an exploit has to issue a OID_GEN_CURRENT_PACKET_FILTER NDIS request with NDIS_PACKET_TYPE_ALL_LOCAL flags and set the BPF program. The exploit is triggered by reading the first received network packet. The researcher has provided a proof of concept affecting the 64-bit version of PcaSp60.sys driver which is part of ASUS PCE-AC56 WLAN Card Utilities. However, other utilities and programs making use of this driver may also be affected. Identifying vulnerable software may be difficult due to variations in driver name, version, or device name or information, but the vulnerable driver is most likely included in OEM WiFi utility programs. Some common default naming convention for the affected drivers include: PcaSp60.sys\nPcaSp50.sys\nPcaMp60.sys\nPcaMp50.sys\nFor more information, see the researcher's blog post.",
  "ID": "VU#600671",
  "IDNumber": "600671",
  "IPProtocol": "",
  "Impact": "A local authenticated attacker may be able to execute a malicious BPF program that can execute arbitrary code with SYSTEM privileges.",
  "Keywords": [
    "bpf",
    "ndis",
    "memory"
  ],
  "Overview": "PCAUSA's Rawether framework does not properly validate BPF data, allowing a crafted malicious BPF program to perform operations on memory outside of its typical bounds on the driver's receipt of network packets. This vulnerability may be exploited to perform local privilege escalation on Windows systems.",
  "References": [
    "http://blog.rewolf.pl/blog/?p=1778",
    "http://cwe.mitre.org/data/definitions/119.html",
    "https://www.kernel.org/doc/Documentation/networking/filter.txt",
    "https://msdn.microsoft.com/en-us/windows/hardware/drivers/network/introduction-to-ndis-protocol-drivers"
  ],
  "Resolution": "Apply an update or uninstall affected software Apply an update to any software that makes use of the Rawether driver. Alternately, uninstall any affected software. A list of possibly affected vendors is given below and will be updated as we learn more.",
  "Revision": 35,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This issue was reported publicly by \"ReWolf\" (@rwfpl).",
  "Title": "PCAUSA Rawether for Windows local privilege escalation",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "2",
  "VRDA_D1_Population": "2",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}