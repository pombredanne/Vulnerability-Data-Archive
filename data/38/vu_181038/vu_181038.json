{
  "Author": "This document was written by Jeffrey S. Havrilla and Will Dormann.",
  "CAM_AttackerAccessRequired": "16",
  "CAM_EaseOfExploitation": "10",
  "CAM_Exploitation": "17",
  "CAM_Impact": "19",
  "CAM_InternetInfrastructure": "10",
  "CAM_Population": "20",
  "CAM_ScoreCurrent": 53.58,
  "CAM_ScoreCurrentWidelyKnown": 53.58,
  "CAM_ScoreCurrentWidelyKnownExploited": 57,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2005-4560",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2005-12-28T08:23:34-05:00",
  "DateFirstPublished": "2005-12-28T11:59:50-05:00",
  "DateLastUpdated": "2007-05-21T10:30:00-04:00",
  "DatePublic": "2005-12-27T00:00:00",
  "Description": "",
  "ID": "VU#181038",
  "IDNumber": "181038",
  "IPProtocol": "",
  "Impact": "A remote, unauthenticated attacker may be able to execute arbitrary code if the user is persuaded to view a specially crafted Windows Metafile.",
  "Keywords": [
    "Microsoft Windows",
    "Windows Metafile files",
    "arbitrary code execution",
    ".wmf",
    "Windows Picture and Fax Viewer",
    "GDI32.DLL",
    "bloodhound",
    "GDI32.LIB",
    "SETABORTPROC",
    "gdi escape",
    "SetWinMetaFileBits",
    "PlayMetaFile"
  ],
  "Overview": "Microsoft Windows is vulnerable to remote code execution via an error in handling files using the Windows Metafile image format. Exploit code has been publicly posted and used to successfully attack fully-patched Windows XP SP2 systems. However, other versions of the Windows operating system also may be at risk.",
  "References": [
    "http://www.microsoft.com/technet/security/advisory/912840.mspx",
    "http://support.microsoft.com/kb/81497",
    "http://blogs.technet.com/msrc/archive/2006/01/13/417431.aspx",
    "http://www.hexblog.com/2005/12/wmf_vuln.html",
    "http://support.microsoft.com/kb/84984",
    "http://msdn.microsoft.com/library/en-us/gdi/prntspol_0d6b.asp",
    "http://windowssdk.msdn.microsoft.com/library/en-us/gdi/prntspol_9kok.asp",
    "http://msdn.microsoft.com/library/en-us/gdi/prntspol_0883.asp",
    "http://msdn.microsoft.com/library/en-us/dnanchor/html/gdi.asp",
    "http://msdn.microsoft.com/library/en-us/gdi/sec_gdi.asp",
    "http://msdn.microsoft.com/library/en-us/gdi/metafile_0hmb.asp",
    "http://msdn.microsoft.com/library/en-us/gdi/metafile_1xwz.asp",
    "http://isc.sans.org/diary.php?storyid=994",
    "http://isc.sans.org/diary.php?rss&storyid=972",
    "http://isc.sans.org/diary.php?storyid=975",
    "http://secunia.com/advisories/18255/",
    "http://www.securityfocus.com/bid/16074",
    "http://vil.mcafeesecurity.com/vil/content/v_137760.htm",
    "http://www.f-secure.com/weblog/archives/archive-122005.html#00000753",
    "http://www.symantec.com/avcenter/venc/data/bloodhound.exploit.56.html",
    "http://www.ciac.org/ciac/bulletins/q-085.shtml",
    "http://www.juniper.net/security/auto/vulnerabilities/vuln2830.html",
    "http://www.osvdb.org/displayvuln.php?osvdb_id=21987",
    "http://xforce.iss.net/xforce/alerts/id/211",
    "http://securitytracker.com/alerts/2005/Dec/1015416.html",
    "http://www.sysinternals.com/blog/2006/01/inside-wmf-backdoor.html"
  ],
  "Resolution": "Apply a patch from your vendor\nMicrosoft addresses this issue with the updates listed in Microsoft Security Bulletin MS06-001. This update disables support for SETABORTPROC in a WMF image. Note: If Windows Picture and Fax Viewer was un-registered as a workaround, it can be re-registered after installation of the MS06-001 update with the following command: regsvr32 %windir%\\system32\\shimgvw.dll\nIf an unofficial hotfix was installed as a workaround, it should be uninstalled after the installation of the MS06-001 update.",
  "Revision": 101,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "Microsoft Windows Metafile handler SETABORTPROC GDI Escape vulnerability",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Workarounds: Disable or reset the file association for Windows Metafiles Disabling or remapping Windows Metafile  files to open a program other than the default Windows Picture and Fax Viewer may prevent exploitation via some attack vectors. Microsoft has suggested taking the following steps to disable shimgvw.dll in Microsoft Security Advisory (912840): Microsoft has tested the following workaround. While this workaround will not correct the underlying vulnerability, it will help block known attack vectors. When a workaround reduces functionality, it is identified in the following section. Un-register the Windows Picture and Fax Viewer (Shimgvw.dll) on Windows XP Service Pack 1; Windows XP Service Pack 2; Windows Server 2003 and Windows Server 2003 Service Pack 1\nTo un-register Shimgvw.dll, follow these steps: Click Start, click Run, type \"regsvr32 -u %windir%\\system32\\shimgvw.dll\" (without the quotation marks), and then click OK. A dialog box appears to confirm that the un-registration process has succeeded. Click OK to close the dialog box. Impact of Workaround: The Windows Picture and Fax Viewer will no longer be started when users click on a link to an image type that is associated with the Windows Picture and Fax Viewer. To undo this change, re-register Shimgvw.dll by following the above steps. Replace the text in Step 1 with \"regsvr32 %windir%\\system32\\shimgvw.dll\" (without the quotation marks). Install an unofficial hotfix Ilfak Guilfanov has provided a hotfix to intercept calls to the Escape function in GDI32.DLL. With this hotfix installed, calls to the obsolete SETABORTPROC GDI Escape will reportedly fail. This appears to prevent exploitation of this vulnerability. Note that this is not an official fix from Microsoft. Please take the appropriate risk assessment steps to determine whether such a hotfix should be installed in your environment. Do not access Windows Metafiles from untrusted sources Exploitation occurs by accessing a specially crafted Windows Metafile. By only accessing Windows Metafiles from trusted or known sources, the chances of exploitation are reduced. Attackers may host malicious Windows Metafiles on web sites. In order to convince users to visit their sites, those attackers often use a variety of techniques to create misleading links including URL encoding, IP address variations, long URLs, and intentional misspellings. Do not click on unsolicited links received in email, instant messages, web forums, or internet relay chat (IRC) channels. Type URLs directly into the browser to avoid these misleading links. While these are generally good security practices, following these behaviors will not prevent exploitation of this vulnerability in all cases, particularly if a trusted site has been compromised or allows cross-site scripting. Please note that Windows Metafile data may be saved with an extension other than WMF. A file with any extension that is associated with Windows Picture and Fax Viewer can be used to exploit this vulnerability. By default, Windows Picture and Fax Viewer is associated with the following file extensions: BMP DIB GIF EMF JFIF JPE JPEG JPG PNG TIF TIFF WMF\nBlock access to Windows Metafiles at network perimeters By blocking access to Windows Metafiles using HTTP proxies, mail gateways, and other network filter technologies, system administrators may also limit potential attack vectors. Please be aware we have confirmed that filtering based just on the WMF file extensions or MIME type application/x-msMetafile will not block all known attack vectors for this vulnerability. Filter mechanisms should be looking for any file that Microsoft Windows recognizes as a Windows Metafile by virtue of its file header. Please check with your network vendor for updated signatures. WMF files can begin with various byte sequences such as: 01 00 09 00 ... 02 00 09 00 ... D7 CD C6 9A ... Disable downloads in Internet Explorer Disabling downloads in the Internet Explorer Internet Zone (or any zone used by an attacker) appears to help prevent exploitation of this vulnerability. This can be achieved by changing the Internet Zone security setting to \"High.\"  Instructions for changing zone security settings can be found in the Malicious Web Scripts FAQ. While this change does not remove the vulnerability, it does help to prevent a common attack vector."
}