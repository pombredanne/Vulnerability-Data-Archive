{
  "Addendum": "US-CERT has no additional comments at this time.",
  "DateLastUpdated": "2005-06-13T10:19:00-04:00",
  "DateNotified": "",
  "DateResponded": "",
  "ID": "VU#888294",
  "Revision": 3,
  "Status": "Vulnerable",
  "Vendor": "Squid",
  "VendorInformation": "We are not aware of further vendor information regarding this vulnerability.",
  "VendorRecordID": "JGEI-6DBJSD",
  "VendorReferences": "",
  "VendorStatement": "Squid Proxy Cache Security Update Advisory SQUID-2005:4 Advisory ID:            SQUID-2005:4\nDate:                   April 23, 2005\nSummary:                HTTP Request Smuggling Vulnerabilities\nAffected versions:      Squid 2.5.STABLE7 and earlier http://www.squid-cache.org/Advisories/SQUID-2005_4.txt Problem Description: Squid is susceptible to a class of attacks known as \"HTTP Request\n Smuggling.\"  These attacks involve sending malformed HTTP requests\n that cause Squid and an upstream HTTP agent (origin server or\n another proxy) to disagree on the boundary between HTTP requests\n on a persistent connection. For example, if a PUT or POST request contains two Content-Length\n headers, one agent may use the first value, while the other agent\n uses the second value. If the PUT/POST body contains data that\n looks like another HTTP request, the two agents become out-of-sync. This may lead to cache poisoning. Other attack vectors include whitespace in HTTP header names and\n extra CR characters at the end of header lines. Severity: This problem is serious because it allows an attacker to poison\n Squid's cache. However, the major aspects of this problem is easily fixed by\n disabling (at least temporarily) HTTP persistent connections. Some of these issues is usually minor in nature and Squid will\n only warn when encountering them, but if you are in a complex\n hierarchy of proxy servers the situation may be worse allowing\n bypass of certain access controls or the like. If you want Squid\n to be strict about this class of protocol violations and reject\n any such requests or responses then set the new\n relaxed_header_parser directive to off. Collateral Damage: After closing these vulnerabilities, Squid rejects certain\n malformed HTTP requests and responses. Your users may see\n failures (error messages) for sites that used to work because\n the protocol error was unnoticed by earlier versions of Squid,\n and warning messages will be seen in cache.log for even more\n sites where Squid can recover unambiguously. When encountering such sites it is important you work with the\n site owner to make their servers comply with the HTTP\n specifications. Most of these problems with servers not complying\n to the HTTP specifications can not be worked around in a safe\n manner. Updated Packages: This bug is fixed by Squid version 2.5.STABLE8. In addition, an individual patch for this issues can be found in\n our patch archive for version Squid-2.5.STABLE7: http://www.squid-cache.org/Versions/v2/2.5/bugs/#squid-2.5.STABLE7-header_parsing If you are using a prepackaged version of Squid then please refer\n to the package vendor for availability information on updated\n packages. Determining if your version is vulnerable: Squid versions up to, and including, 2.5.STABLE7 are vulnerable. Workarounds: The simplest workaround is to disable HTTP persistent connections. Add these lines to your squid.conf: client_persistent_connections off\n     server_persistent_connections off This closes most issues relating to Squid and the cache, but not\n all forms of the attack in general. Contact details for the Squid project: For installation / upgrade support: Your first point of contact\n should be your binary package vendor. If your install is built from the original Squid sources, then\n the squid-users@squid-cache.org mailing list is your primary\n support point. (see <http://www.squid-cache.org/mailing-lists.html>\n for subscription details) For bug reporting, particularly security related bugs the\n squid-bugs@squid-cache.org mailing list is the appropriate forum. It's a closed list (though anyone can post) and security related\n bug reports are treated in confidence until the impact has been\n established. For non security related bugs, the squid bugzilla\n database should be used <http://www.squid-cache.org/bugs/>. Credits: The vulnerability was reported by Steve Orrin at Watchfire Revision history: 2005-04-23 07:15 GMT Initial version END"
}