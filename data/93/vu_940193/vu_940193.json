{
  "Author": "This document was written by Will Dormann.",
  "CAM_AttackerAccessRequired": "18",
  "CAM_EaseOfExploitation": "15",
  "CAM_Exploitation": "18",
  "CAM_Impact": "15",
  "CAM_InternetInfrastructure": "10",
  "CAM_Population": "20",
  "CAM_ScoreCurrent": 72.9,
  "CAM_ScoreCurrentWidelyKnown": 72.9,
  "CAM_ScoreCurrentWidelyKnownExploited": 75.9375,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2010-2568",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2010-07-15T15:56:16-04:00",
  "DateFirstPublished": "2010-07-15T17:58:26-04:00",
  "DateLastUpdated": "2010-12-06T17:00:00-05:00",
  "DatePublic": "2010-07-10T00:00:00",
  "Description": "Microsoft Windows supports the use of shortcut or LNK files. A LNK file is a reference to a local file. A PIF file is a shortcut to a MS-DOS application. Clicking on a LNK or PIF file has essentially the same outcome as clicking on the file that is specified as the shortcut target. For example, clicking a shortcut to calc.exe will launch calc.exe, and clicking a shortcut to readme.txt will open readme.txt with the associated application for handling text files. Microsoft Windows fails to safely obtain icons for shortcut files. When Windows displays Control Panel items, it will initialize each object for the purpose of providing dynamic icon functionality. This means that a Control Panel applet will execute code when the icon is displayed in Windows. Through use of a shortcut file, an attacker can specify a malicious DLL that is to be processed within the context of the Windows Control Panel, which will result in arbitrary code execution. The specified code may reside on a USB drive, local or remote filesystem, a CD-ROM, or other locations. Viewing the location of a shortcut file with Windows Explorer is sufficient to trigger the vulnerability. By default, Microsoft Windows has AutoRun/AutoPlay features enabled. These features can cause Windows to automatically open Windows Explorer when a removable drive, such as a USB thumb drive, is connected. Other applications that display file icons can be used as an attack vector for this vulnerability as well. When used in conjunction with a WebDav resource, Internet Explorer can be used as an attack vector for this vulnerability. With the case of Internet Explorer, no user interaction beyond viewing a web page is required to trigger the vulnerability. This vulnerability is being exploited in the wild to spread malware (stuxnet) that targets control systems. Exploit code for this vulnerability is publicly available.",
  "ID": "VU#940193",
  "IDNumber": "940193",
  "IPProtocol": "",
  "Impact": "By convincing a user to display a specially-crafted shortcut file, an attacker may be able to execute arbitrary code with the privileges of the user. Depending on the operating system and AutoRun/AutoPlay configuration, this can happen automatically by connecting a USB device. This vulnerability can also be triggered by viewing a web page with Internet Explorer or opening a document with Microsoft Office.",
  "Keywords": [
    "shortcut",
    "usb",
    "autorun",
    "LNK",
    "PIF",
    "scada",
    "shell",
    "iconhandler",
    "stuxnet"
  ],
  "Overview": "Microsoft Windows automatically executes code specified in shortcut (LNK and PIF) files.",
  "References": [
    "http://www.microsoft.com/technet/security/bulletin/ms10-046.mspx",
    "http://www.microsoft.com/technet/security/advisory/2286198.mspx",
    "http://support.microsoft.com/kb/2286198",
    "http://isc.sans.edu/diary.html?storyid=9190",
    "http://www.securityfocus.com/bid/41732",
    "http://secunia.com/advisories/40647/",
    "http://support.microsoft.com/kb/967715",
    "http://www.anti-virus.by/en/tempo.shtml",
    "http://krebsonsecurity.com/2010/07/experts-warn-of-new-windows-shortcut-flaw/",
    "http://www.f-secure.com/weblog/archives/new_rootkit_en.pdf",
    "http://www.f-secure.com/weblog/archives/00001986.html",
    "http://www.f-secure.com/weblog/archives/00001987.html",
    "http://support.automation.siemens.com/WW/view/en/43876783"
  ],
  "Resolution": "Apply an update\nThis issue is addressed in Microsoft Security Bulletin MS10-046. Also consider the following workarounds:",
  "Revision": 83,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This vulnerability was discovered by VirusBlokAda through its exploitation in the wild.",
  "Title": "Microsoft Windows automatically executes code specified in shortcut files",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Disable the displaying of icons for shortcuts According to Microsoft Security Advisory 2286198: Note See Microsoft Knowledge Base Article 2286198 to use the automated Microsoft Fix it solution to enable or disable this workaround. Note Using Registry Editor incorrectly can cause serious problems that may require you to reinstall your operating system. Microsoft cannot guarantee that problems resulting from the incorrect use of Registry Editor can be solved. Use Registry Editor at your own risk. For information about how to edit the registry, view the \"Changing Keys And Values\" Help topic in Registry Editor (Regedit.exe) or view the \"Add and Delete Information in the Registry\" and \"Edit Registry Data\" Help topics in Regedt32.exe. Click Start, click Run, type Regedit in the Open box, and then click OK. Locate and then click the following registry key: HKEY_CLASSES_ROOT\\lnkfile\\shellex\\IconHandler\nClick the File menu and select Export. In the Export Registry File dialog box, enter LNK_Icon_Backup.reg and click Save. Note This will create a backup of this registry key in the My Documents folder by default\nSelect the value (Default) on the right hand window in the Registy Editor. Press Enter to edit the value of the key. Remove the value, so that the value is blank, and press Enter. Locate and then click the following registry key: HKEY_CLASSES_ROOT\\piffile\\shellex\\IconHandler\nClick the File menu and select Export. In the Export Registry File dialog box, enter PIF_Icon_Backup.reg and click Save. Note This will create a backup of this registry key in the My Documents folder by default. Select the value (Default) on the right hand window in the Registy Editor. Press Enter to edit the value of the key. Remove the value, so that the value is blank, and press Enter. Log all users off and on again, or restart the computer. Note that this mitigation may prevent Windows shortcuts from displaying some icons. Disable AutoRun Disabling AutoRun can increase the amount of user interaction that is required to trigger this vulnerability. It will not block the vulnerability, however. Please see Microsoft Support article 967715 for more details. Setting the NoDriveTypeAutoRun registry entry to 0xFF should provide the highest amount of protection. Use least privilege Use \"least privilege\" approach to user accounts. By reducing the privileges of the user accounts, the impact of this and other vulnerabilties may be reduced. More information about this technique is available in the Microsoft TechNet article Applying the Principle of Least Privilege to User Accounts on Windows XP. Note that these concepts still apply to Windows Vista and newer operating systems. Disable the WebClient service According to Microsoft Security Advisory 2286198: Disabling the WebClient service helps protect affected systems from attempts to exploit this vulnerability by blocking the most likely remote attack vector through the Web Distributed Authoring and Versioning (WebDAV) client service. After applying this workaround, it will still be possible for remote attackers who successfully exploited this vulnerability to cause Microsoft Office Outlook to run programs located on the targeted user's computer or the Local Area Network (LAN), but users will be prompted for confirmation before opening arbitrary programs from the Internet. To disable the WebClient Service, follow these steps: Click Start, click Run, type Services.msc and then click OK. Right-click WebClient service and select Properties. Change the Startup type to Disabled. If the service is running, click Stop. Click OK and exit the management application. Block outgoing SMB traffic Block outgoing connections on ports 139/tcp, 139/udp, 445/tcp, and 445/udp at your network perimeter. Doing so will help prevent machines on the local network from connecting to SMB servers on the internet. While this does not remove the vulnerability, it does block an attack vector for this vulnerability. Use a web browser other than Internet Explorer Internet Explorer is very closely integrated with the Microsoft Windows operating system. Because of this, Internet Explorer can often be used as an attack vector for vulnerabilities in the Microsoft Windows operating system. In this case, Internet Explorer can be used to trigger the vulnerability with no user interaction required beyond visiting a malicious or compromised website. Other browsers appear to require additional user interaction."
}