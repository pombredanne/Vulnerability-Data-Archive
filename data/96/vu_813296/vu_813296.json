{
  "Author": "This document was written by Garret Wassermann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2016-2118",
    "CVE-2016-0128"
  ],
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "N",
  "CVSS_BaseScore": 8.8,
  "CVSS_BaseVector": "AV:N/AC:M/Au:N/C:C/I:C/A:N",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 6.8687510697792,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "POC",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 6.9,
  "CVSS_TemporalVector": "E:POC/RL:OF/RC:C",
  "DateCreated": "2016-03-24T08:44:41-04:00",
  "DateFirstPublished": "2016-04-12T13:59:37-04:00",
  "DateLastUpdated": "2016-04-18T14:17:00-04:00",
  "DatePublic": "2016-04-12T00:00:00",
  "Description": "CWE-757: Selection of Less-Secure Algorithm During Negotiation ('Algorithm Downgrade') - CVE-2016-2118, CVE-2016-0128 The SAMR and LSAD remote protocols are used by Windows and Samba (for UNIX-like platforms) to authenticate users to a Windows domain. A flaw in the way these protocols establish RPC channels may allow an attacker to impersonate an authenticated user or gain access to the SAM database. CVE-2016-2118 identifies this vulnerability in Samba, while CVE-2016-0128 identifies this vulnerability in Windows. From Microsoft's security bulletin MS16-047 for CVE-2016-0128: An elevation of privilege vulnerability exists in the Security Account Manager (SAM) and Local Security Authority (Domain Policy) (LSAD) remote protocols when they accept authentication levels that do not protect the RPC channel adequately. The vulnerability is caused by the way the SAM and LSAD remote protocols establish the Remote Procedure Call (RPC) channel. An attacker who successfully exploited this vulnerability could gain access to the SAM database. To exploit the vulnerability, an attacker could launch a man-in-the-middle (MiTM) attack, force a downgrade of the authentication level of the RPC channel, and then impersonate an authenticated user. A number of other related vulnerabilities also exist only in Samba. For more information, please see the researcher's 'Badlock' website. The CVSS score below is based on CVE-2016-2118.",
  "ID": "VU#813296",
  "IDNumber": "813296",
  "IPProtocol": "",
  "Impact": "A remote attacker with network access to perform a man-in-the-middle attack may be able to impersonate an authenticated user or gain access to the SAM database. Additionally, an attacker may use this vulnerability to launch a denial of service attack.",
  "Keywords": [
    "sam",
    "lsad",
    "rpc",
    "samba",
    "windows"
  ],
  "Overview": "The Security Account Manager Remote (SAMR) and Local Security Authority (Domain Policy) (LSAD) protocols do not properly establish Remote Procedure Call (RPC) channels, which may allow any attacker to impersonate an authenticated user or gain access to the SAM database, or launch denial of service attacks. This vulnerability is also known publicly as \"Badlock\".",
  "References": [
    "http://badlock.org/",
    "https://www.samba.org/samba/security/CVE-2016-2118.html",
    "https://www.samba.org/samba/latest_news.html#4.4.2",
    "https://technet.microsoft.com/library/security/MS16-047",
    "http://rhelblog.redhat.com/2016/04/15/how-badlock-was-discovered-and-fixed/",
    "https://isc.sans.edu/forums/diary/Getting+Ready+for+Badlock/20877/",
    "http://cwe.mitre.org/data/definitions/757.html"
  ],
  "Resolution": "Apply an update Affected users of supported versions of Microsoft Windows should apply updates from Windows Update as soon as possible. Affected users of Samba versions 4.2, 4.3, and 4.4 should update to the latest bugfix release (at least 4.2.10, 4.3.7, or 4.4.1, respectively). Samba versions 4.1 and prior have been discontinued and will not receive security updates. Network administrators may also consider the following workarounds:",
  "Revision": 50,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Credit to Stefan Metzmacher for discovering and publicly disclosing this issue in coordination with Microsoft.",
  "Title": "Microsoft Windows and Samba may allow spoofing of authenticated users (\"Badlock\")",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Configure SMB for mitigating man-in-the-middle According to 'Badlock' website, it is recommended that administrators set these additional options, if compatible with their network environment: server signing = mandatory\nntlm auth = no Restrict Network Access As a general good security practice, only allow connections from trusted hosts and networks. Consult your firewall product's manual for more information."
}