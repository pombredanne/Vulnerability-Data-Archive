{
  "Author": "This document was produced as a collaborative effort of the CERT/CC Vulnerability Analysis team.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "N",
  "CVSS_BaseScore": 8.5,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:C/I:P/A:N",
  "CVSS_CollateralDamagePotential": "LM",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 8.63466154524,
  "CVSS_EnvironmentalVector": "CDP:LM/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "H",
  "CVSS_IntegrityImpact": "P",
  "CVSS_RemediationLevel": "W",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 8.1,
  "CVSS_TemporalVector": "E:H/RL:W/RC:C",
  "DateCreated": "2015-02-19T09:14:01-05:00",
  "DateFirstPublished": "2015-02-19T15:27:00-05:00",
  "DateLastUpdated": "2015-03-17T14:22:00-04:00",
  "DatePublic": "2015-02-19T00:00:00",
  "Description": "Komodia Redirector SDK is a self-described \"interception engine\" designed to enable developers to integrate proxy services and web traffic modification (such as ad injection) into their applications. With the SSL Digestor module, HTTPS traffic can also be manipulated. This is accomplished by installing a root CA certificate into browser trusted certificate stores, enabling the proxy to effectively man-in-the-middle all web traffic without raising any flags for the end-user. In multiple applications implementing Komodia's libraries, such as Superfish Visual Discovery and KeepMyFamilySecure, the root CA certificates have been found to use trivially obtainable, publicly disclosed, hard-coded private keys. Note that these keys appear to be distinct per application, though the same methods have proven successful in revealing the private keys in each instance. In addition to sharing root CA certificates across installation, it has been reported that the SSL validation that Komodia itself performs is broken. This vulnerability can allow an attacker to universally attack all installations of Komodia Redirector, rather than needing to focus on a single application / certificate. Users should be aware that uninstalling affected applications is not sufficient to remove the security risk since the root certificates are not removed in the process. Lenovo, whose consumer-grade systems come bundled with the software, have provided instructions and an automated removal tool. A list of potentially affected Lenovo systems is available here. Users can verify whether their systems contain Superfish and other Komodia root certificates by visiting this site.",
  "ID": "VU#529496",
  "IDNumber": "529496",
  "IPProtocol": "",
  "Impact": "An attacker can spoof HTTPS sites and intercept HTTPS traffic without triggering browser certificate warnings in affected systems.",
  "Keywords": [
    "lenovo",
    "superfish",
    "keepmyfamilysecure",
    "komodia",
    "redirector",
    "ssl digestor"
  ],
  "Overview": "Komodia Redirector with SSL Digestor installs non-unique root CA certificates and private keys, making systems broadly vulnerable to HTTPS spoofing",
  "References": [
    "http://blog.erratasec.com/2015/02/extracting-superfish-certificate.html",
    "http://www.komodia.com/ad-injection-sdk/",
    "https://filippo.io/Badfish/",
    "https://blog.filippo.io/komodia-superfish-ssl-validation-is-broken/",
    "http://news.lenovo.com/article_display.cfm?article_id=1929",
    "https://forums.lenovo.com/t5/Lenovo-P-Y-and-Z-series/Lenovo-Pre-instaling-adware-spam-Superfish-powerd-by/m-p/1863174#M79882",
    "https://forums.lenovo.com/t5/Lenovo-P-Y-and-Z-series/Removal-Instructions-for-VisualDiscovery-Superfish-application/ta-p/2029206",
    "http://news.lenovo.com/article_display.cfm?article_id=1929&cid=ww:social:147924660:147924659:TWITTER:lenovo:*%20Customer%20Service%20and%20Support&linkId=12450493",
    "http://www.komodia.com/wiki/index.php/Komodia%27s_Redirector",
    "http://www.komodia.com/wiki/index.php/SSL_Digestor",
    "http://www.keepmyfamilysecure.com/about/",
    "http://www.komodia.com/wiki/index.php/Komodia%27s_Redirector#When_do_I_need_the_SSL_Digestor.3F",
    "http://marcrogers.org/2015/02/19/lenovo-installs-adware-on-customer-laptops-and-compromises-all-ssl/",
    "https://www.facebook.com/notes/protect-the-graph/windows-ssl-interception-gone-wild/1570074729899339?_fb_noscript=1",
    "http://support.lenovo.com/us/en/product_security/superfish_uninstall",
    "http://www.komodia.com/security-notice"
  ],
  "Resolution": "Apply an update Komodia has updated their vulnerable libraries. Developers who use the Komodia libraries should update their applications. Users should check vendor websites for updates to affected software and apply them immediately. Given the severity of the issue, users who are unsure that an update addresses the vulnerability are strongly encouraged to consider the following workaround.",
  "Revision": 130,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "The CERT/CC wishes to thank the following for their contributions to this report: Marc Rogers, https://twitter.com/marcwrogers\nRob Graham, https://twitter.com/erratarob\nTwitter user TheWack0lian https://twitter.com/TheWack0lian\nChris Palmer, https://twitter.com/fugueish\nFilippo Valsorda, https://twitter.com/FiloSottile",
  "Title": "Komodia Redirector with SSL Digestor fails to properly validate SSL and installs non-unique root CA certificates and private keys",
  "US-CERTTechnicalAlert": "TA15-051A",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 3,
  "Workarounds": "Uninstall software using Komodia Redirector SDK and associated root CA certificates Uninstall any software that includes the Komodia Redirector and SSL Digestor libraries. Refer to the Vendor Information section below for an updated list of known affected vendors. After uninstalling an offending application, it is also necessary to independently remove compromised root CA certificates. Note that the names of these certificates are likely to vary based on the originating application. Microsoft provides guidance on deleting and managing certificates in the Windows certificate store. Mozilla provides similar guidance for their software, including the Firefox and Thunderbird certificate stores."
}