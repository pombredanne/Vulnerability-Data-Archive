{
  "Addendum": "ftp://ftp.sco.com/pub/updates/UnixWare/SCOSA-2005.2/SCOSA-2005.2.txt",
  "DateLastUpdated": "2005-01-26T12:10:00-05:00",
  "DateNotified": "",
  "DateResponded": "",
  "ID": "VU#536120",
  "Revision": 3,
  "Status": "Vulnerable",
  "Vendor": "SCO",
  "VendorInformation": "We are not aware of further vendor information regarding this vulnerability.",
  "VendorRecordID": "JGEI-68XU7V",
  "VendorReferences": "",
  "VendorStatement": "-----BEGIN PGP SIGNED MESSAGE-----\nHash: SHA1 SCO Security Advisory Subject:\t\t \t\t UnixWare 7.1.4 UnixWare 7.1.3 UnixWare 7.1.1 : chroot A known exploit can break a chroot prison. Advisory number: \t\t SCOSA-2005.2\nIssue date: \t\t \t\t 2005 January 14\nCross reference:\t\t sr887824 fz528555 erg712509 CAN-2004-1124 1. Problem Description chroot() is a system call that is often used to provide an\n\t\t additional layer of security when untrusted programs are\n\t\t run. The call to chroot() is normally used to ensure that\n\t\t code run after it can only access files at or below a given\n\t\t directory. Originally, chroot() was used to test systems software in \n\t\t a safe environment. It is now generally used to lock users \n\t\t into an area of the file system so that they can not look \n\t\t at or affect the important parts of the system they are on. Several programs use chroot jails to ensure that even if \n\t\t you break into the process's address space, you can't do \n\t\t anything harmful to the whole system. If chroot() can be \n\t\t broken then this precaution is broken. A known exploit can break a chroot prison. The Common Vulnerabilities and Exposures project \n\t\t (cve.mitre.org) has assigned the name CAN-2004-1124 to t\n\t\t his issue. A new file system tunable, CHROOT_SECURITY is provided to\n\t\t protect against the known exploit for escaping from a chroot\n\t\t prison. The new tunable is described in /etc/conf/dtune.d/fs\n\t\t and defined in /etc/conf/mtune.d/fs. Protection is provided\n\t\t by the default value of 1 but traditional behavior may be\n\t\t obtained by resetting CHROOT_SECURITY to 0. chroot() is a good way to increase the security of the\n\t\t software provided that secure programming guidelines are \n\t\t utilized and chroot() system call limitations are taken \n\t\t into account. Chrooting will prevent an attacker from \n\t\t reading files outside the chroot jail and will prevent \n\t\t many local UNIX attacks (such as SUID abuse and /tmp \n\t\t race conditions). The number of ways that root user can break out of chroot \n\t\t is huge. If there is no root user defined within the \n\t\t chroot environment, no SUID binaries, no devices, and \n\t\t the daemon itself dropped root privileges right after \n\t\t calling chroot() call breaking out of chroot appears to \n\t\t be impossible. 2. Vulnerable Supported Versions System\t\t \t\t \t\t \t\t Binaries UnixWare 7.1.4 \t\t \t\t \t\t /etc/conf/pack.d/namefs/Driver_atup.o\n\t\t \t\t \t\t \t\t \t\t /etc/conf/pack.d/namefs/Driver_mp.o\n\t\t \t\t \t\t \t\t \t\t /usr/include/sys/vfs.h UnixWare 7.1.3 \t\t \t\t \t\t See Maintainance pack 4 UnixWare 7.1.1 \t\t \t\t \t\t See Maintainance pack 5 3. Solution The proper solution is to install the latest packages. 4. UnixWare 7.1.4 4.1 Location of Fixed Binaries ftp://ftp.sco.com/pub/updates/UnixWare/SCOSA-2005.2 4.2 Verification MD5 (erg712629c.pkg.Z) = 480ecc98f9c918a3b35082c1bef2aa44 md5 is available for download from\n\t\t \t\t ftp://ftp.sco.com/pub/security/tools 4.3 Installing Fixed Binaries Upgrade the affected binaries with the following sequence: Download erg712629c.pkg.Z to the /var/spool/pkg directory # uncompress /var/spool/pkg/erg712629c.pkg.Z\n\t\t # pkgadd -d /var/spool/pkg/erg712629c.pkg 5. UnixWare 7.1.3 5.1 Location of Fixed Binaries The fixes are available in SCO UnixWare Release 7.1.3\n        Maintenance Pack 4 or later. See ftp://ftp.sco.com/pub/unixware7/713/mp/mp4/uw713mp4.txt\n\t\t or\n\t\t ftp://ftp.sco.com/pub/unixware7/713/mp/mp4/uw713mp4.html 5.2 Verification MD5 (uw713mp4.image) = 7eb9e20ed6a6d9ed1ab7335323bf25d1 md5 is available for download from\n\t\t \t\t ftp://ftp.sco.com/pub/security/tools 5.3 Installing Fixed Binaries Upgrade the affected binaries with the following sequence: Download uw713mp4.image to the /var/spool/pkg directory # pkgadd -d /var/spool/pkg/uw713mp4.image 6. UnixWare 7.1.1 6.1 Location of Fixed Binaries The fixes are available in SCO UnixWare Release 7.1.1\n\t\t Maintenance Pack 5 or later. See ftp://ftp.sco.com/pub/unixware7/uw711pk/uw711mp5.txt\n\t\t and\n\t\t ftp://ftp.sco.com/pub/unixware7/uw711pk/uw711mp5_errata.txt 6.2 Verification MD5 (uw711mp5.cpio.Z) = 50bd66b7d57b2025da9dca4010d0ab1a md5 is available for download from\n\t\t \t\t ftp://ftp.sco.com/pub/security/tools 6.3 Installing Fixed Binaries See uw711mp5.txt and uw711mp5_errata.txt for install instructions. 7. References Specific references for this advisory: http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-1124 \n\t\t \t\t http://www.packetfactory.net/projects/libexploit/ \n\t\t \t\t http://www.bpfh.net/simes/computing/chroot-break.html\n\t\t \t\t http://www.linuxsecurity.com/content/view/117632/49/ SCO security resources: http://www.sco.com/support/security/index.html SCO security advisories via email\n\t\t \t\t http://www.sco.com/support/forums/security.html This security fix closes SCO incidents sr887824 fz528555\n\t\t erg712509. 8. Disclaimer SCO is not responsible for the misuse of any of the information\n\t\t we provide on this website and/or through our security\n\t\t advisories. Our advisories are a service to our customers\n\t\t intended to promote secure installation and use of SCO\n\t\t products. 9. Acknowledgments SCO would like to thank Simon Roses Femerling -----BEGIN PGP SIGNATURE-----\nVersion: GnuPG v1.4.0 (SCO/UNIX_SVR5) iD8DBQFB6GDDaqoBO7ipriERAgpwAJ9ohWuGizBGP5rLwQfBvMkDtZdVIQCfQQaF\n+ysj7pTq2BCUn+5vqu7CJvA=\n=EDUn\n-----END PGP SIGNATURE-----"
}