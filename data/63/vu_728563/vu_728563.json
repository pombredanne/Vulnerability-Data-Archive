{
  "Author": "This document was written by Art Manion and Shawn Van Ittersum.",
  "CAM_AttackerAccessRequired": "20",
  "CAM_EaseOfExploitation": "15",
  "CAM_Exploitation": "0",
  "CAM_Impact": "7",
  "CAM_InternetInfrastructure": "7",
  "CAM_Population": "17",
  "CAM_ScoreCurrent": 18.073125,
  "CAM_ScoreCurrentWidelyKnown": 18.073125,
  "CAM_ScoreCurrentWidelyKnownExploited": 31.460625,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2002-0189",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2002-04-17T14:25:44-04:00",
  "DateFirstPublished": "2003-04-25T12:08:54-04:00",
  "DateLastUpdated": "2007-06-05T10:01:00-04:00",
  "DatePublic": "2002-04-17T00:00:00",
  "Description": "",
  "ID": "VU#728563",
  "IDNumber": "728563",
  "IPProtocol": "",
  "Impact": "An attacker who is able to convince a user to access a specially crafted HTML document, such as an Internet web page or HTML email message, could execute arbitrary script in a different domain. When combined with cross-site scripting vulnerabilities in local HTML resources [VU#711843], the script could execute with privileges of the user in the security context of the Local Machine Zone. The script could read certain types of local files in known locations. In conjunction with other vulnerabilities (VU#626395, VU#25249), the script could execute arbitrary commands on the user's system. From MS03-004: An attacker could use this vulnerability to create a web page that would allow the attacker to access data across domains. This could include reading local system files not in use by the user or the operating system, provided the attacker knew the full path and file name. It could also include accessing any data that a user chose to share with another web site. In the worst case, this vulnerability could allow an attacker to load a malicious executable onto the system and execute it. However, the attack would only be possible against a domain or zone where there was content that handled dialogue box data in a special manner. Pages like this exist in the My Computer zone, but may not necessarily exist on a target web site. [VU#711843]",
  "Keywords": [
    "Microsoft Internet Explorer",
    "destination URL",
    "cross-site scripting",
    "css",
    "multiple domains",
    "shdoclc.dll",
    "ANALYZE.DLG",
    "property",
    "redirect",
    "MS02-023",
    "IFRAME",
    "Microsoft",
    "Internet Explorer",
    "dialogArguments",
    "showModalDialog",
    "bad parent",
    "res://shdoclc.dll/privacypolicy.dlg",
    "openModalDialog",
    "showModelessDialog",
    "response.redirect",
    "ms02-047",
    "ms03-004"
  ],
  "Overview": "Microsoft Internet Explorer (IE) allows script from a dialog frame in one domain to execute in a different domain, including the Local Machine Zone. The script could read certain local files and data (i.e. cookies) from other web sites. In the presence of other vulnerabilities (VU#626395, VU#25249), the script could execute arbitrary commands.",
  "References": [
    "http://www.pivx.com/larholm/adv/TL002/default.htm",
    "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0189",
    "http://www.microsoft.com/technet/security/bulletin/MS02-023.asp",
    "http://online.securityfocus.com/bid/4527",
    "http://security.greymagic.com/adv/gm001-ax/",
    "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2002-0691",
    "http://microsoft.com/technet/security/bulletin/MS02-047.asp",
    "http://online.securityfocus.com/bid/5561",
    "http://www.iss.net/security_center/static/9938.php",
    "http://www16.brinkster.com/liudieyu/BadParent/BadParent-CONTENT.txt",
    "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-1326",
    "http://microsoft.com/technet/security/bulletin/MS03-004.asp",
    "http://www.securityfocus.com/bid/6205",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodaldialog.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/showmodelessdialog.asp",
    "http://msdn.microsoft.com/workshop/author/om/xframe_scripting_security.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/sec_dhtml.asp",
    "http://msdn.microsoft.com/workshop/author/om/doc_object.asp",
    "http://msdn.microsoft.com/workshop/author/om/windows_frames_dialogs.asp",
    "http://msdn.microsoft.com/workshop/author/om/windows_frames_dialogs.asp#sec_dialogs",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/properties/dialogarguments.asp",
    "http://msdn.microsoft.com/workshop/security/szone/overview/overview.asp#default_zones",
    "http://support.microsoft.com/support/kb/articles/Q182/5/69.ASP ",
    "http://msdn.microsoft.com/workshop/browser/webbrowser/browser_control_ovw_entry.asp",
    "http://msdn.microsoft.com/library/default.asp?url=/library/en-us/cpref/html/frlrfsystemwebhttpresponseclassredirecttopic.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/objects/iframe.asp",
    "http://msdn.microsoft.com/library/default.asp?url=/workshop/author/dhtml/reference/properties/innerhtml.asp"
  ],
  "Resolution": "Apply Patch\nApply Q810847 or a more recent cumulative patch. See Microsoft Security Bulletin MS03-004 for more information.",
  "Revision": 57,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Several variations of this vulnerability were publicly reported by Thor Larholm, GreyMagic Software, and Liu Die Yu.",
  "Title": "Microsoft Internet Explorer does not adequately validate source of dialog frame",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Disable Active scripting Active scripting is required to open a modal dialog frame and populate dialogArguments. At a minimum, disable Active scripting in the Internet zone and the zone used by Outlook, Outlook Express, or any other email client that uses Internet Explorer or the WebBrowser control to render HTML. Instructions for disabling Active scripting can be found in the CERT/CC Malicious Web Scripts FAQ. Apply the Outlook Email Security Update Another way to effectively disable Active scripting in Outlook is to install the Outlook Email Security Update. The update configures Outlook to open email messages in the Restricted Sites Zone, where Active scripting is disabled by default. In addition, the update provides further protection against malicious code that attempts to propagate via Outlook. The Outlook Email Security Update is available for Outlook 98 and Outlook 2000. The functionality of the Outlook Email Security Update is included in Outlook 2002 and Outlook Express 6. Update HTML Help To protect against arbitrary command execution, install an updated version of HTML Help (811630). As described in Microsoft Security Bulletin MS03-015, the updated HHCtrl ActiveX control disables the Shortcut command in a compiled help file that has been opened with the showHelp method: Only supported protocols [http:, https:, file:, ftp:, ms-its:, or mk:@MSITStore:] can be used with showHelp to open a web page or help (chm) file. The shortcut function supported by HTML Help will be disabled when the help file is opened with showHelp This will not affect the shortcut functionality if the same CHM file is opened by the user manually by double-clicking on the help file, or by through an application on the local system using the HTMLHELP( ) API. Note that the patches referenced in MS03-004 and MS03-015 completely disable the showHelp method. After installing either one of these patches, Internet Explorer will not be able to open help files. Restrict HTML Help commands Restrict the execution of the Shortcut and WinHelp HTML Help commands to specified folders, or disable the commands entirely. As in the previous recommendation, this technique will protect against arbitrary command execution via HTML Help. Details are available in Microsoft Knowledge Base Article 810687."
}