{
  "Author": "This document was written by Ryan Giobbi and Will Dormann.",
  "CAM_AttackerAccessRequired": "16",
  "CAM_EaseOfExploitation": "15",
  "CAM_Exploitation": "4",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "4",
  "CAM_Population": "16",
  "CAM_ScoreCurrent": 40.32,
  "CAM_ScoreCurrentWidelyKnown": 40.32,
  "CAM_ScoreCurrentWidelyKnownExploited": 63.36,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2007-6166",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2007-11-23T11:38:42-05:00",
  "DateFirstPublished": "2007-11-24T11:50:10-05:00",
  "DateLastUpdated": "2008-01-10T19:38:00-05:00",
  "DatePublic": "2007-11-23T00:00:00",
  "Description": "",
  "ID": "VU#659761",
  "IDNumber": "659761",
  "IPProtocol": "tcp",
  "Impact": "By convincing a user to connect to a specially crafted RTSP stream, a remote, unauthenticated attacker may be able to execute arbitrary code on a vulnerable system. An attacker can use various types of web page content, including a QuickTime Media Link file, to cause a user to load an RTSP stream.",
  "Keywords": [
    "Apple",
    "QuickTime",
    "RTSP",
    "Content-type",
    "stack buffer overflow",
    "rtsp://",
    "QTL",
    ".qtl",
    "quicktime media link",
    "INFO#111001"
  ],
  "Overview": "Apple QuickTime contains a stack buffer overflow vulnerability that may allow a remote, unauthenticated attacker to execute arbitrary code or cause a denial-of-service condition.",
  "References": [
    "http://docs.info.apple.com/article.html?artnum=307176",
    "http://www.beskerming.com/security/2007/11/25/74/QuickTime_-_Remote_hacker_automatic_control",
    "http://tools.ietf.org/html/rfc2326",
    "http://tools.ietf.org/html/rfc2326#section-12.16",
    "http://www.apple.com/quicktime/technologies/streaming/",
    "http://www.gnucitizen.org/blog/backdooring-mp3-files/",
    "http://developer.apple.com/quicktime/icefloe/dispatch028.html",
    "http://www.apple.com/quicktime/resources/qt/us/proxy/",
    "http://www.milw0rm.com/exploits/4648",
    "http://www.milw0rm.com/exploits/4651",
    "http://www.milw0rm.com/exploits/4657",
    "http://quicktime.tc.columbia.edu/users/iml/movies/mtest.html",
    "http://www.symantec.com/enterprise/security_response/weblog/2007/12/exploit_for_apple_quicktime_vu.html",
    "http://www.rubicode.com/Software/RCDefaultApp/"
  ],
  "Resolution": "Apple has released QuickTime 7.3.1 to address this issue. Until updates can be applied, please consider the following workarounds. Note that these workarounds block certain attack vectors, but do not remove the vulnerability.",
  "Revision": 70,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This vulnerability was publicly disclosed by Krystian Kloskowski.",
  "Title": "Apple QuickTime RTSP Content-Type header stack buffer overflow",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Uninstall QuickTime Until updates are available, uninstalling QuickTime will mitigate this vulnerability. Note that uninstalling QuickTime will make applications that rely on QuickTime (such as iTunes) fail to run or run with limited functionality. Block the rtsp:// protocol Blocking the RTSP protocol with proxy or firewall rules may help mitigate this vulnerability. Blocking outbound access to 554/tcp and 6970-6999/udp may partially mitigate this vulnerability. Since RTSP may use a variety of port numbers, blocking the protocol based on a particular port may not be sufficient. Secure your web browser Follow the guidelines described in the Securing Your Web Browser document. These guidelines include several mitigations against this vulnerability, such as disabling downloads from untrusted sites in Internet Explorer on Microsoft Windows systems and disabling the option to Open \"safe\" files after downloading in Safari on Apple Mac systems. Disable the QuickTime ActiveX controls in Internet Explorer The QuickTime ActiveX controls can be disabled in Internet Explorer by setting the kill bit for the following CLSIDs: {02BF25D5-8C17-4B23-BC80-D3488ABDDC6B} {4063BE15-3B08-470D-A0D5-B37161CFFD69} More information about how to set the kill bit is available in Microsoft Support Document 240797. Alternatively, the following text can be saved as a .REG file and imported to set the kill bit for these controls: Windows Registry Editor Version 5.00 [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{02BF25D5-8C17-4B23-BC80-D3488ABDDC6B}] \"Compatibility Flags\"=dword:00000400 [HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Internet Explorer\\ActiveX Compatibility\\{4063BE15-3B08-470D-A0D5-B37161CFFD69}] \"Compatibility Flags\"=dword:00000400\nDisable the QuickTime plug-in for Mozilla-based browsers Users of Mozilla-based browsers, such as Firefox can disable the QuickTime plugin, as specified in the PluginDoc article Uninstalling Plugins. Disable the RTSP protocol handler Mac OS X users can disable the RTSP protocol handler by editing the ~/Library/Preferences/com.apple.LaunchServices.plist file with Property List Editor. Change the LSHandlerRoleAll value associated with the rtsp LSHanlderURLScheme to something other than com.apple.quicktimeplayer. This process can be simplified by using an application such as RCDefaultApp. Microsoft Windows users should not need to make any changes, as QuickTime does not appear to register itself as the handler for the RTSP protocol on Windows systems. Disable file association for QuickTime files Disable the file association for QuickTime file types to help prevent windows applications from using Apple QuickTime to open QuickTime files. This can be accomplished by deleting the following registry keys: HKEY_CLASSES_ROOT\\QuickTime.*\nThis will remove the association for approximately 32 file types that are configured to open with the QuickTime Player software. Disable QuickTime as the RTSP protocol handler on OS X To disable the RTSP registered protocol handler in OS X open ~/Library/Preferences/com.apple.LaunchServices.plist and look through a\nhundred or more entries to find RTSP and change it to something else. Disable JavaScript For instructions on how to disable JavaScript, please refer to the Securing Your Web Browser document. This can help prevent some attack techniques that use the QuickTime plug-in or ActiveX control. Do not access QuickTime files from untrusted sources Attackers may host malicious QuickTime files on web sites. In order to convince users to visit their sites, those attackers often use a variety of techniques to create misleading links including URL encoding, IP address variations, long URLs, and intentional misspellings. Do not click on unsolicited links received in email, instant messages, web forums, or internet relay chat (IRC) channels. Type URLs directly into the browser to avoid these misleading links. While these are generally good security practices, following these behaviors will not prevent exploitation of this vulnerability in all cases, particularly if a trusted site has been compromised or allows cross-site scripting."
}