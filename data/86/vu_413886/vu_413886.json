{
  "Author": "This document was written by Art Manion.",
  "CAM_AttackerAccessRequired": "20",
  "CAM_EaseOfExploitation": "15",
  "CAM_Exploitation": "0",
  "CAM_Impact": "10",
  "CAM_InternetInfrastructure": "5",
  "CAM_Population": "20",
  "CAM_ScoreCurrent": 28.125,
  "CAM_ScoreCurrentWidelyKnown": 28.125,
  "CAM_ScoreCurrentWidelyKnownExploited": 50.625,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2003-0823",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2004-02-02T15:48:00-05:00",
  "DateFirstPublished": "2004-02-02T18:55:27-05:00",
  "DateLastUpdated": "2005-02-08T14:55:00-05:00",
  "DatePublic": "2003-09-10T00:00:00",
  "Description": "",
  "ID": "VU#413886",
  "IDNumber": "413886",
  "IPProtocol": "",
  "Impact": "By convincing a victim to click on a link in an HTML document (web page, HTML email), an attacker could write arbitrary files to a vulnerable system within the security context of the user running IE. These files could contain code that could be executed through other means. MS04-004 elaborates:  \"Although this code could not be executed through this vulnerability directly, the operating system might open the file if it is dropped to a sensitive location, or a user may click the file inadvertently, causing the attacker's code to be executed.\"  One example of a \"sensitive location\" is the user's Startup folder (shell:startup). In combination with a vulnerability in the way IE handles files for drag and drop operations (VU#526089), an attacker could write arbitrary files by convincing a user to click anywhere within the attacker's HTML document or on the scroll bar of the document window. Given the ability to spoof GUI elements, including the entire desktop (VU#490708), an attacker could easily convince a user to click on the attacker's HTML document.",
  "Keywords": [
    "Microsoft",
    "Internet Explorer",
    "hijackclick",
    "hijackclickv2",
    "hijackclickv3",
    "MS04-004",
    "832894",
    "saveref",
    "function pointer",
    "method caching",
    "drag and drop",
    "drag-and-drop",
    "Popup.show()",
    "window.moveBy()",
    "window.resizeBy()"
  ],
  "Overview": "Microsoft Internet Explorer (IE) dynamic HTML (DHTML) mouse events can manipulate windows to copy objects from one domain to another, including the Local Machine Zone. This vulnerability could allow an attacker to write arbitrary files to the local file system.",
  "References": [
    "http://www.securityfocus.com/archive/1/336992",
    "http://www.securityfocus.com/archive/1/345626",
    "http://www.safecenter.net/UMBRELLAWEBV4/HijackClick/HijackClick-Content.HTM",
    "http://www.safecenter.net/UMBRELLAWEBV4/HijackClickV2/HijackClickV2-Content.htm",
    "http://freehost07.websamba.com/greyhats/hijackclick3.htm",
    "http://www.microsoft.com/technet/security/bulletin/MS03-048.asp",
    "http://www.microsoft.com/technet/security/bulletin/MS04-004.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/dhtml_reference_entry.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/events.asp",
    "http://support.microsoft.com/?kbid=307594",
    "http://support.microsoft.com/?kbid=291387",
    "http://support.microsoft.com/?kbid=831167",
    "http://support.microsoft.com/?kbid=888534",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/resizeby.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/resizeto.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/moveby.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/moveto.asp",
    "http://msdn.microsoft.com/workshop/author/dhtml/reference/methods/show.asp",
    "http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-1027",
    "http://www.cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2003-0823",
    "http://cve.mitre.org/cgi-bin/cvename.cgi?name=CAN-2004-0841",
    "http://www.secunia.com/advisories/9711/",
    "http://www.secunia.com/advisories/10289/",
    "http://secunia.com/advisories/12048/",
    "http://www.securityfocus.com/bid/9009",
    "http://www.securityfocus.com/bid/9108",
    "http://www.securityfocus.com/bid/10690 ",
    "http://xforce.iss.net/xforce/xfdb/13679",
    "http://xforce.iss.net/xforce/xfdb/13844",
    "http://xforce.iss.net/xforce/xfdb/16675"
  ],
  "Resolution": "Apply a patch\nApply the patch (834707) referenced in Microsoft Security Bulletin MS04-038 (\"Script in Image Tag File Download Vulnerability\").",
  "Revision": 86,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This vulnerability and the first two attack vectors (HijackClick and HijackClickV2) were publicly reported by Liu Die Yu. The third vector, Hijack Click 3, was publicly reported by Paul. Thanks to Microsoft for information used in this document.",
  "Title": "Microsoft Internet Explorer allows mouse events to manipulate window objects and perform \"drag and drop\" operations",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": "Upgrade to Windows XP Service Pack 2 Service Pack 2 for Windows XP addresses all three attack vectors. Disable Active scripting and ActiveX controls For systems not running Windows XP SP2, disable Active scripting and ActiveX controls for untrusted sites. At a minimum, disable Active scripting in the Internet zone and the zone used by Outlook, Outlook Express, or any other software that uses the WebBrowser ActiveX control or the IE HTML rendering engine (MSHTML). Instructions for disabling Active scripting and ActiveX controls can be found in the Malicious Web Scripts FAQ. Apply the Outlook Email Security Update Another way to effectively disable Active scripting and ActiveX controls in Outlook is to install the Outlook Email Security Update. The update configures Outlook to open email messages in the Restricted Sites Zone, where Active scripting and ActiveX controls are disabled by default. In addition, the update provides further protection against malicious code that attempts to propagate via Outlook. The Outlook Email Security Update is available for Outlook 98 and Outlook 2000. The functionality of the Outlook Email Security Update is included in Outlook 2002 and Outlook Express 6. Render email in plain text Configure email client software (mail user agent [MUA]) to render email messages in plaint text. Instructions to configure Outlook 2002 and Outlook Express 6 are available in Microsoft Knowledge Base Articles 307594 and 291387, respectively. HTML-formatted email messages may not appear properly, however script will not be evaluated, thus preventing certain types of attacks. Maintain updated antivirus software Antivirus software with updated virus definitions may identify and prevent some exploit attempts. Variations of exploits or attack vectors may not be detected. Do not rely on antivirus software to defend against this vulnerability. Use a different web browser There are a number of significant vulnerabilities in technologies relating to the IE domain/zone security model, the DHTML object model, MIME type determination, the graphical user interface (GUI), and ActiveX. It is possible to reduce exposure to these vulnerabilities by using a different web browser, especially when browsing untrusted sites. Such a decision may, however, reduce the functionality of sites that require IE-specific features such as DHTML, VBScript, and ActiveX. Note that using a different web browser will not remove IE from a Windows system, and other programs may invoke IE, the WebBrowser ActiveX control (WebOC), or the HTML rendering engine (MSHTML)."
}