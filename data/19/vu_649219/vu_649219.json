{
  "Author": "This document was written by Jared Allar.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2012-0217",
    "CVE-2006-0744"
  ],
  "CVSS_AccessComplexity": "M",
  "CVSS_AccessVector": "L",
  "CVSS_Authenication": "S",
  "CVSS_AvailabilityImpact": "C",
  "CVSS_BaseScore": 6.6,
  "CVSS_BaseVector": "AV:L/AC:M/Au:S/C:C/I:C/A:C",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 5.5,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "C",
  "CVSS_RemediationLevel": "OF",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "ND",
  "CVSS_TemporalScore": 5.5,
  "CVSS_TemporalVector": "E:F/RL:OF/RC:C",
  "DateCreated": "2012-05-01T11:28:53-04:00",
  "DateFirstPublished": "2012-06-12T13:22:46-04:00",
  "DateLastUpdated": "2012-10-18T14:18:00-04:00",
  "DatePublic": "2006-04-12T00:00:00",
  "Description": "A ring3 attacker may be able to specifically craft a stack frame to be executed by ring0 (kernel) after a general protection exception (#GP). The fault will be handled before the stack switch, which means the exception handler will be run at ring0 with an attacker's chosen RSP causing a privilege escalation. Details from Xen CVE-2012-0217 / XSA-7 - 64-bit PV guest privilege escalation vulnerability A vulnerability which can allow a 64-bit PV guest kernel running on a 64-bit hypervisor to escalate privileges to that of the host by arranging for a system call to return via sysret to a non-canonical RIP. Intel CPUs deliver the resulting exception in an undesirable processor state. Details from FreeBSD FreeBSD-SA-12:04.sysret: Privilege escalation when returning from kernel FreeBSD/amd64 runs on CPUs from different vendors. Due to varying behaviour of CPUs in 64 bit mode a sanity check of the kernel may be insufficient when returning from a system call. Successful exploitation of the problem can lead to local kernel privilege escalation, kernel data corruption and/or crash. Details from Microsoft User Mode Scheduler Memory Corruption Vulnerability - MS12-042 - Important An elevation of privilege vulnerability exists in the way that the Windows User Mode Scheduler handles system requests. An attacker who successfully exploited this vulnerability could run arbitrary code in kernel mode. An attacker could then install programs; view, change, or delete data; or create new accounts with full administrative rights. Mitigating Factors for User Mode Scheduler Memory Corruption Vulnerability Mitigation refers to a setting, common configuration, or general best-practice, existing in a default state, that could reduce the severity of exploitation of a vulnerability. The following mitigating factors may be helpful in your situation: An attacker must have valid logon credentials and be able to log on locally to exploit this vulnerability. The vulnerability could not be exploited remotely or by anonymous users. This vulnerability only affects Intel x64-based versions of Windows 7 and Windows Server 2008 R2. Systems with AMD or ARM-based CPUs are not affected by this vulnerability. Details from Red Hat RHSA-2012:0720-1 & RHSA-2012:0721-1:  It was found that the Xen hypervisor implementation as shipped with Red Hat Enterprise Linux 5 did not properly restrict the syscall return addresses in the sysret return path to canonical addresses. An unprivileged user in a 64-bit para-virtualized guest, that is running on a 64-bit host that has an Intel CPU, could use this flaw to crash the host or, potentially, escalate their privileges, allowing them to execute arbitrary code at the hypervisor level. (CVE-2012-0217, Important) Details from some affected vendors were not available at the time of publication.",
  "ID": "VU#649219",
  "IDNumber": "649219",
  "IPProtocol": "",
  "Impact": "A local authenticated attacker may exploit this vulnerability for operating system privilege escalation or for a guest-to-host virtual machine escape.",
  "Keywords": [
    "sysret",
    "#gp",
    "x86_64 OS"
  ],
  "Overview": "Some 64-bit operating systems and virtualization software running on Intel CPU hardware are vulnerable to a local privilege escalation attack. The vulnerability may be exploited for local privilege escalation or a guest-to-host virtual machine escape. Intel claims that this vulnerability is a software implementation issue, as their processors are functioning as per their documented specifications. However, software that fails to take the Intel-specific SYSRET behavior into account may be vulnerable.",
  "References": [
    "http://en.wikipedia.org/wiki/Ring_3",
    "http://lists.xen.org/archives/html/xen-announce/2012-06/msg00001.html",
    "http://blog.xen.org/index.php/2012/06/13/the-intel-sysret-privilege-escalation/",
    "https://bugzilla.redhat.com/show_bug.cgi?id=813428",
    "http://security.freebsd.org/advisories/FreeBSD-SA-12:04.sysret.asc",
    "http://blog.gmane.org/gmane.linux.kernel.commits.2-4/month=20060401",
    "http://lists.xen.org/archives/html/xen-devel/2012-06/msg01072.html",
    "http://www.vupen.com/blog/20120904.Advanced_Exploitation_of_Xen_Sysret_VM_Escape_CVE-2012-0217.php"
  ],
  "Resolution": "Apply an Update\nPlease review the Vendor Information section of this document for vendor-specific patch and workaround details.",
  "Revision": 88,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Rafal Wojtczuk of Bromium, Inc. for reporting this vulnerability.",
  "Title": "SYSRET 64-bit operating system privilege escalation vulnerability on Intel CPU hardware",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}