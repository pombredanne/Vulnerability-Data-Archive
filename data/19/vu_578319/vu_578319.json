{
  "Author": "This document was written by Will Dormann.",
  "CAM_AttackerAccessRequired": "18",
  "CAM_EaseOfExploitation": "18",
  "CAM_Exploitation": "0",
  "CAM_Impact": "14",
  "CAM_InternetInfrastructure": "10",
  "CAM_Population": "17",
  "CAM_ScoreCurrent": 43.3755,
  "CAM_ScoreCurrentWidelyKnown": 43.3755,
  "CAM_ScoreCurrentWidelyKnownExploited": 72.2925,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2010-06-10T09:05:50-04:00",
  "DateFirstPublished": "2010-06-10T10:21:03-04:00",
  "DateLastUpdated": "2011-10-21T13:12:00-04:00",
  "DatePublic": "2010-06-09T00:00:00",
  "Description": "Microsoft Windows Help and Support Center is the default handler for the hcp protocol on Windows XP and 2003 systems. When an hcp:// URI is encountered, Windows will launch the Help and Support Center application, which is provided by helpctr.exe. When helpctr.exe is invoked from an hcp:// URI, it operates in a more restricted mode by using the -FromHCP command-line parameter. This is supposed to restrict the Help and Support Center to a whitelisted set of help documents and parameters. The UrlUnescape function that is used by helpctr.exe contains an error that allows an attacker to bypass the whitelist restrictions provided by the -FromHCP option. By leveraging an XSS vulnerability in an existing Help and Support Center document, an attacker can inject arbitrary script commands into a Help and Support Center session. Because the Help and Support Center documents are located in a trusted zone, this can allow arbitrary Windows commands to be executed.",
  "ID": "VU#578319",
  "IDNumber": "578319",
  "IPProtocol": "",
  "Impact": "By causing Microsoft Windows to handle a specially crafted hcp:// URI, a remote, unauthenticated attacker can execute arbitrary commands with the privileges of the user. This can happen as the result of viewing a specially crafted webpage, opening a Windows Media Player file, or through the use of other attack vectors.",
  "Keywords": [
    "Microsoft",
    "Windows",
    "helpctr.exe",
    "Invalid URL Processing",
    "arbitrary code",
    "security bypass",
    "hcp",
    "urlunescape",
    "ms10-jul"
  ],
  "Overview": "The Microsoft Windows Help and Support Center application fails to properly sanitize hcp:// URIs, which can allow a remote, unauthenticated attacker to execute arbitrary commands.",
  "References": [
    "http://www.microsoft.com/technet/security/Bulletin/MS10-042.mspx",
    "http://seclists.org/fulldisclosure/2010/Jun/205",
    "http://www.microsoft.com/technet/security/advisory/2219475.mspx",
    "http://blogs.technet.com/b/msrc/archive/2010/06/10/windows-help-vulnerability-disclosure.aspx",
    "http://blogs.technet.com/b/srd/archive/2010/06/10/help-and-support-center-vulnerability-full-disclosure-posting.aspx",
    "http://technet.microsoft.com/en-us/library/bb490918.aspx",
    "http://msdn.microsoft.com/en-us/library/bb773791%28VS.85%29.aspx",
    "http://secunia.com/advisories/40076",
    "http://www.theregister.co.uk/2010/06/10/windows_help_bug/"
  ],
  "Resolution": "Apply an update\nThis issue is addressed in Microsoft Security Bulletin MS10-042.",
  "Revision": 33,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This vulnerability was discovered and publicly reported by Tavis Ormandy.",
  "Title": "Microsoft Windows Help and Support Center URI processing vulnerability",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Disable the HCP protocol handler This vulnerability can be mitigated by removing the HCP protocol handler. This can be accomplished by removing the HKEY_CLASSES_ROOT\\HCP\\shell\\open registry key. Note that this may interfere with Windows functionality that relies on the HCP protocol. Secure your web browser This vulnerability can be mitigated by following the guidelines outlined in the Securing Your Web Browser document. This can help mitigate attacks that use web browsers as attack vectors. Update Windows Media Player A fully patched Windows XP system will come with Windows Media Player 9 by default. Windows Media Player versions 10 and later have some security improvements, such as prompting before loading external web content. Although it does not address the underlying vulnerability, upgrading to Windows Media Player 10 or later can help mitigate some attack vectors by prompting the user."
}