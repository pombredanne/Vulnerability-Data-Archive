{
  "Author": "This document was written by Will Dormann.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2017-0199",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "P",
  "CVSS_BaseScore": 7.5,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "P",
  "CVSS_EnvironmentalScore": 6.75490483120688,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:H/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "P",
  "CVSS_RemediationLevel": "W",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "H",
  "CVSS_TemporalScore": 6.8,
  "CVSS_TemporalVector": "E:F/RL:W/RC:C",
  "DateCreated": "2017-04-10T11:30:23-04:00",
  "DateFirstPublished": "2017-04-10T12:31:20-04:00",
  "DateLastUpdated": "2017-04-21T10:22:00-04:00",
  "DatePublic": "2017-04-07T00:00:00",
  "Description": "Microsoft OLE uses the URL Moniker to processes remotely-linked content in a vulnerable manner. The remote content is opened based on the application associated with the server-provided MIME type. Some MIME types are dangerous, as they can result in code execution. For example, the application/hta mime type is associated with mshta.exe. Opening arbitrary HTA content is equivalent to executing arbitrary code. This vulnerability is reportedly being exploited in the wild. The exploits used in the wild have the following characteristics: The document that triggers the URL Moniker vulnerability is an RTF document that masquerades as a Microsoft Word DOC file. The exploit connects to a remote server to obtain an execute an HTA file, which contains VBScript to be executed by the client. Note that depending on the nature of the vulnerability, it may be possible to target Microsoft Windows components other than Microsoft Word. This vulnerability reportedly affects all versions of Microsoft Office, including Office 2016 on Windows 10. It is also reported that Microsoft Office Protected View can help prevent exploitation without user interaction. This vulnerability is reportedly being exploited in the wild.",
  "ID": "VU#921560",
  "IDNumber": "921560",
  "IPProtocol": "",
  "Impact": "By convincing a user to open a specially-crafted document, an unauthenticated remote attacker may be able to execute arbitrary code on a vulnerable system.",
  "Keywords": [
    "OLE2Link",
    "RTF",
    "OLE",
    "Word",
    "HTA",
    "MIME",
    "webdav",
    "objupdate"
  ],
  "Overview": "Microsoft OLE uses the URL Moniker to open application data based on the server-provided MIME type, which can allow an unauthenticated remote attacker to execute arbitrary code on a vulnerable system.",
  "References": [
    "https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199",
    "https://www.fireeye.com/blog/threat-research/2017/04/acknowledgement_ofa.html",
    "https://securingtomorrow.mcafee.com/mcafee-labs/critical-office-zero-day-attacks-detected-wild/",
    "https://blog.nviso.be/2017/04/12/analysis-of-a-cve-2017-0199-malicious-rtf-document/",
    "https://www.mdsec.co.uk/2017/04/exploiting-cve-2017-0199-hta-handler-vulnerability/",
    "https://support.office.com/en-us/article/What-is-Protected-View-d6f09ac7-e6b9-4495-8e43-2bbcdbcb6653",
    "https://support.office.com/en-us/article/What-is-File-Block-10d0e0ab-fecf-4605-befd-1e6563e7686d"
  ],
  "Resolution": "The CERT/CC is currently unaware of a practical solution to this problem. Please consider the following workarounds;",
  "Revision": 65,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Public exploitation of this vulnerability was reported by McAfee and FireEye.",
  "Title": "Microsoft OLE URL Moniker improperly handles remotely-linked HTA data",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "4",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Apply an update This issue is addressed in the following Microsoft Security update: https://portal.msrc.microsoft.com/en-US/security-guidance/advisory/CVE-2017-0199\nPlease refer to this document and install all relevant updates for both Microsoft Windows and Microsoft Office. Note: Even with these updates, remotely-linked OLE content is still retrieved and saved according to server-provided MIME type before any user interaction if the document is not in Protected Mode. The update prevents HTA content from being executed after it has been retrieved in such a manner. Disable the application/hta MIME handler This exploit appears to be blocked by disabling the MIME handler for application/hta. The handler for this MIME type can be overridden with the \"plain text\" handler using the following registry value: Windows Registry Editor Version 5.00 [HKEY_CLASSES_ROOT\\PROTOCOLS\\Filter\\application/hta] \"CLSID\"=\"{5e941d80-bf96-11cd-b579-08002b30bfeb}\" Block RTF documents in Microsoft Word Exploits in the wild utilize RTF documents. RTF documents can be blocked in Microsoft Word by using the File Block Settings in the Microsoft Office Trust Center. For example, the following registry values can be used to block the opening of RTF documents in Word 2016: Windows Registry Editor Version 5.00 [HKEY_CURRENT_USER\\Software\\Microsoft\\Office\\16.0\\Word\\Security\\FileBlock] \"OpenInProtectedView\"=dword:00000000\n\"RtfFiles\"=dword:00000002 For other versions of Office, the path above will need to be modified to match the version number associated with the installed version of Office."
}