{
  "Author": "This document was written by Jared Allar.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE-2012-4948",
  "CVSS_AccessComplexity": "H",
  "CVSS_AccessVector": "A",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "N",
  "CVSS_BaseScore": 4.6,
  "CVSS_BaseVector": "AV:A/AC:H/Au:N/C:C/I:N/A:N",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 3.7,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:ND/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "N",
  "CVSS_RemediationLevel": "W",
  "CVSS_ReportConfidence": "UC",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "ND",
  "CVSS_TemporalScore": 3.7,
  "CVSS_TemporalVector": "E:F/RL:W/RC:UC",
  "DateCreated": "2012-08-28T14:57:21-04:00",
  "DateFirstPublished": "2012-11-02T16:45:21-04:00",
  "DateLastUpdated": "2012-11-02T16:48:00-04:00",
  "DatePublic": "2012-10-22T00:00:00",
  "Description": "Fortigate UTM appliances share the same self-signed Fortigate CA certificate. Companies that use these appliances for deep packet inspection will have most likely deployed the CA certificate to endpoint web browsers so certificate warnings will not be seen by an end-user. Since the associated private key has been compromised (published on the web), an attacker with a man-in-the-middle vantage point on the network will be able to simulate the behavior of the Fortigate appliance and eavesdrop on encrypted communications or spoof websites. Also, the attacker may digitally sign malicious software, spoofing the identity of the publisher.",
  "ID": "VU#111708",
  "IDNumber": "111708",
  "IPProtocol": "",
  "Impact": "Primarily at risk are users who have imported the compromised Fortigate CA certificate into their web browser or operating system. This risk applies equally within the company (connected to a network behind the Fortigate UTM appliance) as anywhere else. An attacker with a man-in-the-middle vantage point on the current network may be able to eavesdrop on encrypted communications. In addition, an attacker may falsify digital signatures such as Authenticode.",
  "Keywords": [
    "fortinet",
    "fortigate",
    "utm",
    "ca",
    "certificate",
    "deep packet inspection",
    "man-in-the-middle",
    "encryption"
  ],
  "Overview": "Fortigate UTM appliances that support SSL/TLS deep packet inspection share the same self-signed Fortigate CA certificate and associated private key across all devices. The private key, which has been compromised, allows attackers to create and sign fake certificates.",
  "References": [
    "http://docs.fortinet.com/fos40hlp/43/wwhelp/wwhimpl/common/html/wwhelp.htm?context=fgt&file=misc_utm_chapter.61.13.html",
    "http://kb.fortinet.com/kb/viewContent.do?externalId=FD32404",
    "http://www.fortinet.com/solutions/unified_threat_management.html",
    "https://media.torproject.org/misc/2012-07-03-cyberoam-CVE-2012-3372.txt",
    "http://docs.fortinet.com/fos40hlp/43/wwhelp/wwhimpl/js/html/wwhelp.htm"
  ],
  "Resolution": "Install a new CA certificate The vendor recommends the following steps be taken to address this vulnerability. Admin creates/obtains a CA certificate for which only they have the private key. Admin installs the CA certificate on FortiGate. Admin uses \"set caname xxx\" to select that certificate for SSL deep inspection. Disable the Fortigate CA certificate Endpoints should not trust the self-signed Fortigate CA certificate. The following certificate information is for the certificate that should be distrusted: Subject: \"E = support@fortinet.com; CN = FortiGate CA; OU = Certificate Authority; O = Fortinet; L = Sunnyvale; S = California; C = US\"; Thumbprint: 3e 20 7f 9a 6b d9 5c 7c 2b 89 11 67 d3 2f 57 87 2f 76 60 14 The preferrable way to distrust a CA certificate is to import it to the \"Untrusted certificates\" branch of the system certificate store. To continue the use of SSL/TLS deep packet inspection, a new, unique, CA certificate may be generated and imported into the Fortigate UTM appliance. To prevent users from  experiencing certificate errors, that new CA certificate can be imported into web browsers. Chapter 6 of the FortiOS handbook contains instructions on how to replace the default CA certificate.",
  "Revision": 20,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Bitwiper for reporting this vulnerability.",
  "Title": "Fortigate UTM appliances share the same default CA certificate",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "2",
  "VRDA_D1_Population": "2",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}