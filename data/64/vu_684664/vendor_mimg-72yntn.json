{
  "Addendum": "See http://www.mirrorservice.org/sites/download.sourceforge.net/pub/sourceforge/l/li/libpng/libpng-1.2.17-ADVISORY.txt for more details.",
  "DateLastUpdated": "2007-05-16T14:53:00-04:00",
  "DateNotified": "2007-05-07T13:42:32-04:00",
  "DateResponded": "",
  "ID": "VU#684664",
  "Revision": 2,
  "Status": "Vulnerable",
  "Vendor": "libpng",
  "VendorInformation": "We are not aware of further vendor information regarding this vulnerability.",
  "VendorRecordID": "MIMG-72YNTN",
  "VendorReferences": "",
  "VendorStatement": "A grayscale PNG image with a malformed (bad CRC) tRNS chunk will crash some libpng applications. This vulnerability could be used to crash a browser when a user tries to view such a malformed PNG file. It is not known whether the vulnerability could be exploited otherwise. The reason is that png_ptr->num_trans is set to 1 and then there is an error return after checking the CRC, so the trans[] array is never allocated. Since png_ptr->num_trans is nonzero, libpng tries to use the array later. This bug was first introduced in libpng version 0.90, in 1996. All versions from libpng-0.90 through libpng-1.2.16 are vulnerable. Here is the fix, thanks to Mats Palmgren: --- pngrutil.c_1.2.16   2007-05-11 23:11:55.395466000 -0500\n+++ pngrutil.c  2007-05-14 04:37:32.101297000 -0500\n@@ -1314,7 +1314,10 @@ if (png_crc_finish(png_ptr, 0)) +      png_ptr->num_trans = 0; return; png_set_tRNS(png_ptr, info_ptr, readbuf, png_ptr->num_trans,\n&(png_ptr->trans_values)); This patch can be applied to any vulnerable version of libpng. Libpng version 1.0.25 and 1.2.17, which are being released concurrently\nwith this advisory, have been patched. This vulnerability has been assigned the identifiers\nCVE-2007-2445 and CERT VU#684664. Glenn Randers-Pehrson\nPNG Development Group"
}