{
  "Author": "This document was written by Michael Orlando.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": [
    "CVE-2012-4962",
    "CVE-2012-4963"
  ],
  "CVSS_AccessComplexity": "H",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "N",
  "CVSS_BaseScore": 5.4,
  "CVSS_BaseVector": "AV:N/AC:H/Au:N/C:C/I:N/A:N",
  "CVSS_CollateralDamagePotential": "LM",
  "CVSS_ConfidentialityImpact": "C",
  "CVSS_EnvironmentalScore": 4.41958891716,
  "CVSS_EnvironmentalVector": "CDP:LM/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "U",
  "CVSS_IntegrityImpact": "N",
  "CVSS_RemediationLevel": "U",
  "CVSS_ReportConfidence": "UC",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 4.1,
  "CVSS_TemporalVector": "E:U/RL:U/RC:UC",
  "DateCreated": "2012-10-02T10:07:25-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2014-07-02T14:44:00-04:00",
  "DatePublic": "2013-08-16T00:00:00",
  "Description": "OneLogin acts as an Identity Provider (IdP) to realize browser-based Single Sign-On (SSO) for numerous cloud-based services/websites (i.e. Service Provider). The IdP authenticates the user and issues a SAML assertion (also referred to as security token) containing certified claims (authentication and authorization information) about the user. The assertion is sent through the web browser to a federated Service Provider (SP) which consumes the token. On the basis of this assertion the SP makes an access control decision. This attack relies on flaws in the IdP's SAML interface implementation and allows the adversary to steal fresh and valid assertions by spoofing the AssertionConsumerServiceURL attribute in an <AuthnRequest> message. This may allow an attacker to compromise a client's SP session. (CVE-2012-4962) SP is a Service Provider, IdP is an Identity Provider, and UA is a User Authentication 1. UA -> Bad Website: User U navigates its web browser UA to the malicious webpage. Therefore, a HTTP GET request for the corresponding URI is sent to the web server. 2. Bad Website -> UA: Bad Website send a webpage with an embedded invisible IFRAME to the UA. 3. UA -> IdP: Triggered by the IFRAME a server authenticated TLS connection is established between UA and IdP. Subsequently, UA uses the established TLS channel to transport a self-generated <AuthnRequest(ID,SP, BadURL)> to the IdP (cf. Listing 1, line 5). According to the SAML V2.0 Standard the <AuthnRequest> SHOULD be signed, but in the case of Onelogin this is not true. 4. UA <-> IdP: The IdP identi\u001ces the User with an arbitrary authentication mechanism. If the session is already opened the authentication step 4 will be skipped. 5. IdP -> UA: The IdP creates an authentication assertion AA = fID; IdP; SP;Ug,including the unique identi\u001cer ID and the entities SP, IdP and the authenticated User U. Subsequently, the whole assertion AA is signed with the IdP's private key K..1IdP . The assertion is embedded into a <AuthnResponse> message and is sent Base64 encoded in an HTML form to the UA. According to the SAML Standard the IdP MUST use the AssertionConsumerService URL ACSURLincluded in <AuthnRequest> as POST destination. 6. UA -> Bad Website: The attacker receives the fresh and valid token created from the IdP. Therefore, he/she can impersonate user U by submitting the message to the ACS URL of the attacked SP. 7. Bad Website -> SP: The SP consumes the assertion AA, veri\u001ces the XML Signature, and checks if the signature was created by a trusted IdP. 8. SP -> Bad Website: the SP believes that User U has successfully authenticated and grants Bad SP access to the protected service or resource. CWE-79: Improper Neutralization of Input During Web Page Generation ('Cross-site Scripting') (CVE-2012-4963)\nOneLogin SAML web interface contains a cross-site scripting vulnerability which could allow an attacker to execute arbitrary script in the context of an authenticated user's session.",
  "ID": "VU#407864",
  "IDNumber": "407864",
  "IPProtocol": "",
  "Impact": "An unauthenticated attacker could steal a user's SAML assertions or execute arbitrary script in the context of an authenticated user's session.",
  "Keywords": [
    "onelogin",
    "saml",
    "cwe-79",
    "spoofing",
    "acs"
  ],
  "Overview": "The OneLogin SAML interface contains a spoofing attack and xss vulnerability which could allow an attacker to steal SAML assertions or execute arbitrary script in the context of an authenticated user's session",
  "References": [
    "http://cwe.mitre.org/data/definitions/79.html",
    "http://www.onelogin.com/"
  ],
  "Resolution": "The vendor has stated the following: We have studied the vulnerability, and applied a whitelist approach to make sure that inbound AuthnRequests Assertion Consumer Service URL's match what is configured on the application in question.\u00a0OneLogin currently supports around 150 different SAML enabled cloud applications, and this approach has been applied to all of them.\u00a0",
  "Revision": 22,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Andreas Mayer (Adolf W\u00fcrth GmbH & Co. KG), Vladislav Mladenov, Marcus Niemietz, and Joerg Schwenk from Horst G\u00f6rtz Institute for IT Security (Ruhr-University Bochum) for reporting this vulnerability.",
  "Title": "OneLogin SAML interface spoofing attack and xss vulnerabilities",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}