{
  "Author": "This document was written by Michael Orlando.",
  "CAM_AttackerAccessRequired": "12",
  "CAM_EaseOfExploitation": "2",
  "CAM_Exploitation": "0",
  "CAM_Impact": "3",
  "CAM_InternetInfrastructure": "3",
  "CAM_Population": "15",
  "CAM_ScoreCurrent": 0.06075,
  "CAM_ScoreCurrentWidelyKnown": 0.46575,
  "CAM_ScoreCurrentWidelyKnownExploited": 0.87075,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "CVE 2011-3328",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2011-09-09T08:03:01-04:00",
  "DateFirstPublished": "2011-09-22T15:46:56-04:00",
  "DateLastUpdated": "2011-09-23T07:27:00-04:00",
  "DatePublic": "2011-09-22T00:00:00",
  "Description": "When libpng encounters a cHRM chunk that is malformed it will perform a divide-by-zero causing libpng to crash. This bug was introduced in libpng version 1.5.4 and has been fixed in libpng version 1.5.5.",
  "ID": "VU#477046",
  "IDNumber": "477046",
  "IPProtocol": "",
  "Impact": "By tricking a user into opening a specifically crafted PNG file within an application that uses libpng, an attacker may be able to cause a denial of service crash. The PNG Development Group has stated that: Such malformed PNG files are not necessarily malevolent (ones have been observed on the Internet that were created by accident) but they will cause a crash anyway.",
  "Keywords": [
    "libpng",
    "DoS",
    "cHRM"
  ],
  "Overview": "libpng crashes when processing malformed cHRM chunks.",
  "References": [
    "http://libpng.sf.net/index.html",
    "ftp://ftp.simplesystems.org/pub/png/src",
    "https://sourceforge.net/tracker/index.php?func=detail&aid=3406145&group_id=5624&atid=105624"
  ],
  "Resolution": "Apply an Update This vulnerability is addressed in the following libpng versions: libpng-1.5.5",
  "Revision": 16,
  "SystemsAffectedPreamble": "According to The PNG Development Group: Those that use a \"system\" libpng that happens to be libpng-1.5.4 are vulnerable to a divide-by-zero crash. Mozilla products that use the embedded libpng are not vulnerable.",
  "ThanksAndCredit": "Thanks to Glenn Randers-Pehrson of the PNG Development Group for reporting this vulnerability.",
  "Title": "libpng malformed cHRM divide-by-zero vulnerability",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 1,
  "Workarounds": "The PNG Development Group recommends upgrading to libpng-1.5.5. However, if you must continue to use libpng-1.5.4, you can apply the following patch to libpng-1.5.4: --- a/libpng/pngrutil.c\n+++ b/libpng/pngrutil.c\n@@ -1037,12 +1037,15 @@ png_handle_cHRM(png_structp png_ptr, png_infop\ninfo_ptr, png_uint_32 length) png_uint_32 w = y_red + y_green + y_blue; - png_ptr->rgb_to_gray_red_coeff = (png_uint_16)(((png_uint_32)y_red *\n- 32768)/w); - png_ptr->rgb_to_gray_green_coeff = (png_uint_16)(((png_uint_32)y_green\n- * 32768)/w); - png_ptr->rgb_to_gray_blue_coeff = (png_uint_16)(((png_uint_32)y_blue *\n- 32768)/w); + if (w != 0) + png_ptr->rgb_to_gray_red_coeff = (png_uint_16)(((png_uint_32)y_red *\n+ 32768)/w); + png_ptr->rgb_to_gray_green_coeff = (png_uint_16)(((png_uint_32)y_green\n+ * 32768)/w); + png_ptr->rgb_to_gray_blue_coeff = (png_uint_16)(((png_uint_32)y_blue *\n+ 32768)/w); #endif"
}