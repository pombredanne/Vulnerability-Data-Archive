{
  "Author": "This document was written by Jeff S Havrilla.",
  "CAM_AttackerAccessRequired": "10",
  "CAM_EaseOfExploitation": "20",
  "CAM_Exploitation": "10",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "3",
  "CAM_Population": "10",
  "CAM_ScoreCurrent": 21,
  "CAM_ScoreCurrentWidelyKnown": 24.75,
  "CAM_ScoreCurrentWidelyKnownExploited": 32.25,
  "CAM_WidelyKnown": "15",
  "CERTAdvisory": "CA-1996-10",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:41:02-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2000-10-17T17:06:00-04:00",
  "DatePublic": "",
  "Description": "We have just discovered a serious problem with the standard\nconfiguration of a Solaris 2.5 NIS+ server.  The permissions on the\nNIS+ passwd table are such that any user with credentials can\nchange their UID to become root.  (Normally all users have\ncredentials, these are not something just given to administrators)\n\nProblems with NIS+ access rights after 2.5 install and 'nisserver\n-r' NIS+ setup\n\nSummary:\n\nAfter installing Solaris 2.5 and then running nisserver -r to\ninitialise the system as a NIS+ root server, the access rights on\nthe passwd map columns are very insecure.  They allow any user to\nchange all the fields in their NIS+ entry, which includes their\nUID.  I tested this and was able to change my UID to 0 with the\ncommand\n\nnistbladm -m uid=0 '[name=username],passwd'\n\nAs you can see nearly every column has r(ead), m(odify), c(reate)\nand d(estroy) permissions for owner and group (the first column is\nnobody, or an unauthenicated person).\n\nWhen a user is added to the NIS+ tables with nisaddent, the\nownership of the entry is automatically set to that user (although\nwe can't find this documented anywhere).  This means that the\n\"owner\" permissions shown above apply to the user for each entry in\nthe password file.",
  "ID": "VU#7970",
  "IDNumber": "7970",
  "IPProtocol": "",
  "Impact": "Users could change their uids to 0 (root) or other users.",
  "Keywords": [
    "nis+",
    "Solaris"
  ],
  "Overview": "",
  "References": [
    " AA-96.02 NIS+ configuration vulnerability",
    "Do the following (courtesy of auscert):",
    "To set the default access rights for the NIS+ passwd table:",
    "# nischmod na-rmcd,og+rmcd passwd.org_dir",
    "To set the column access rights on the NIS+ passwd table:",
    "# nistbladm -u name=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u passwd=na-rmcd,o=m passwd.org_dir",
    "# nistbladm -u uid=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u gid=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u gcos=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u home=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u shell=na-rmcd,n=r passwd.org_dir",
    "# nistbladm -u shadow=na-rmcd passwd.org_dir",
    "After making any changes in access rights, AUSCERT recommends that sites",
    "verify the changes they have made using niscat(1), as shown previously.",
    "Sites that have replica NIS+ servers may use nisping(1m) to propagate",
    "the changes to the replica servers in a timely manner."
  ],
  "Resolution": "",
  "Revision": "1",
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "nis+-initial-configuration",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": "The vulnerability in NIS+ is fixed by the following patches: OS version\t\tPatch ID SunOS 5.4\t\t102277-03\nSunOS 5.4_x86\t102278-03\nSunOS 5.3\t\t101736-04"
}