{
  "Author": "This document was written by old-vul.",
  "CAM_AttackerAccessRequired": "5",
  "CAM_EaseOfExploitation": "20",
  "CAM_Exploitation": "10",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "14",
  "CAM_Population": "14",
  "CAM_ScoreCurrent": 19.95,
  "CAM_ScoreCurrentWidelyKnown": 23.1,
  "CAM_ScoreCurrentWidelyKnownExploited": 28.35,
  "CAM_WidelyKnown": "14",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:42:58-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "1998-05-21T11:43:01-04:00",
  "DatePublic": "",
  "Description": "smail is a setuid(root) program. The user is able to\nspecify a filename to log messages for debugging purposes. This\nlog-file is opened with root-privs thus allowing any user to write\nto any file.",
  "ID": "VU#9884",
  "IDNumber": "9884",
  "IPProtocol": "",
  "Impact": "gain root access by writing to /etc/passwd, /etc/shadow etc.",
  "Keywords": [
    "mail",
    "smail",
    "debug",
    "write_to_file"
  ],
  "Overview": "",
  "References": "problem widely known due to postings in several newsgroups\ncomp.mail.smail, comp.os.linux.*",
  "Resolution": "the given patch is integrated in smail 3.1.29.1",
  "Revision": "1",
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "debug_file",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": "patch available *** Omain.c     Wed Mar 11 12:33:18 1993\n--- main.c      Wed Mar 11 12:59:54 1993 *** 436,458 **** -      * change error file to debugging file from -D option, if any -     if (arg_debug_file) {\n-       new_errfile = fopen(arg_debug_file, \"a\"); -       if (new_errfile == NULL) {\n-           write_log(LOG_TTY, \"Warning: Cannot open debug file %s: %s\\n\",\n-                     arg_debug_file, strerrno(errno)); -           arg_debug_file = NULL; -       } else {\n-           errfile = new_errfile; -           fprintf(errfile, \"\\n%s: Debugging started: pid=%ld\\n\\n\",\n-                   program, (long)getpid()); * read in the transport, router and director files, if needed * NOTE: if queue_only is FALSE and mode is DELIVER_MAIL,\n--- 436,441 ---- *** 525,530 ****\n--- 508,537 ----\nif (prog_euid != REQUIRED_EUID)\nqueue_only = TRUE; #endif +      * change error file to debugging file from -D option, if any +      * JMJ: Change location of this fragment to below the setuid/setgid\n+      *      calls to allow for use of fopen_as_user() instead of just\n+      *      fopen(). +      *      Side effect: -D now requires full pathname to debug file +     if (arg_debug_file) {\n+       new_errfile = fopen_as_user(arg_debug_file, \"a\", 1, real_uid,\n+           prog_egid, 0600); +           write_log(LOG_TTY, \"Warning: Cannot open debug file %s: %s\\n\",\n+                     arg_debug_file, strerrno(errno)); +           arg_debug_file = NULL; +       } else {\n+           errfile = new_errfile; +           fprintf(errfile, \"\\n%s: Debugging started: pid=%ld\\n\\n\",\n+                   program, (long)getpid()); * error processing can be other than TERMINAL only for"
}