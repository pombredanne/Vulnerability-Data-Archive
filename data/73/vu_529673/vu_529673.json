{
  "Author": "This document was written by Art Manion.",
  "CAM_AttackerAccessRequired": "10",
  "CAM_EaseOfExploitation": "10",
  "CAM_Exploitation": "0",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "5",
  "CAM_Population": "17",
  "CAM_ScoreCurrent": 15.9375,
  "CAM_ScoreCurrentWidelyKnown": 15.9375,
  "CAM_ScoreCurrentWidelyKnownExploited": 28.6875,
  "CAM_WidelyKnown": "20",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "2010-11-25T10:25:37-05:00",
  "DateFirstPublished": "2010-11-26T17:40:18-05:00",
  "DateLastUpdated": "2010-11-26T17:40:00-05:00",
  "DatePublic": "2010-11-24T00:00:00",
  "Description": "Microsoft Windows supports end-user-defined characters (EUDC) to allow users to define custom unicode characters. The Windows kernel (win32k.sys) graphics device interface (GDI) reads the EUDC registry key for font information. More specifically, GreEnableEudc() uses RtlQueryRegistryValues() to read  HKCU\\EUDC\\{codepage}\\SystemDefaultEUDCFont. In this case RtlQueryRegistryValues() expects to read a REG_SZ (string) value into a buffer whose length and contents are determined by the type and value of SystemDefaultEUDCFont. By default, an unprivileged user has access to modify the EUDC registry key. Furthermore, RtlQueryRegistryValues() does not validate the data read from SystemDefaultEUDCFont. By changing the type and data of SystemDefaultEUDCFont and enabling EUDC, an attacker can overwrite kernel memory. Publicly available exploit code targets Windows Vista, Windows 7, and Windows Server 2008 platforms. Windows XP and Windows Server 2003 may also be affected.",
  "ID": "VU#529673",
  "IDNumber": "529673",
  "IPProtocol": "",
  "Impact": "An unprivileged local user can execute arbitrary code with SYSTEM privileges.",
  "Keywords": [
    "RtlQueryRegistryValues",
    "EUDC",
    "noobpwnftw"
  ],
  "Overview": "Microsoft Windows does not adequately validate registry data read using the function RtlQueryRegistryValues(). By modifying an EUDC registry key value, a local user could execute arbitrary code with SYSTEM privileges.",
  "References": [
    "http://secunia.com/advisories/42356",
    "http://www.exploit-db.com/exploits/15609/",
    "http://moonslab.com/1195",
    "http://nakedsecurity.sophos.com/2010/11/25/new-windows-zero-day-flaw-bypasses-uac/",
    "http://isc.sans.edu/diary.html?storyid=9988",
    "http://www.prevx.com/blog/160/New-Windows-day-exploit-speaks-chinese.html",
    "http://msdn.microsoft.com/en-us/library/dd317836%28VS.85%29.aspx"
  ],
  "Resolution": "We are currently unaware of a complete solution to this problem.",
  "Revision": 10,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "This vulnerability was publicly disclosed by noobpwnftw.",
  "Title": "Microsoft Windows RtlQueryRegistryValues() does not adequately validate registry data",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "0",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "4",
  "VulnerabilityCount": 1,
  "Workarounds": "Restrict access to EUDC registry key Change the ACL on the EUDC registry key to prevent modifications. The EUDC key is in user registry hives so it may be necessary to make the change under HKCU and all the HKEY_USERS\\* subkeys. Preventing users from changing the types and data in EUDC registry key values will block the specific attack vector described in the initial public disclosure of this vulnerability. There may be other attack vectors in which RtlQueryRegistryValues()is used by the kernel to read registry user-modifiable registry values."
}