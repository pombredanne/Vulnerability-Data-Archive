{
  "Author": "This document was written by Shawn V Hernan.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:46:14-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2002-04-01T21:44:00-04:00",
  "DatePublic": "",
  "Description": "Briefly, the autofs daemon (automountd in Solaris, autofsd in IRIX)\nuses RPC to communicate with the kernel.  It is possible, however,\nfor any user to send it RPC messages and get it to act upon\nuser-supplied [u]mount requests and maps.  Thus, it is possible for\na user to mount a filesystem of his choice over, say, /usr/bin, and\ncontinue from there.  Solaris automountd has a feature in which the\ndaemon will execute the supplied map if possible, and thus the\nSolaris exploit is very trivial, allowing users to run any command\nas root.\n\nThis exploit attacks the autofs automounter, known as automountd(8)\nin Solaris 2.x and autofsd(8) in IRIX.  It has nothing to do with\nthe regular NFS mountd.  Furthermore, there is no chance that any\nvendor who has not implemented the autofs filesystem is vulnerable\nto this specific hole.  SunOS 4.x should also be immune.\n\nBriefly, the automounter daemon takes over automounted filesystems\n(configured by the system administrator) and mounts them on demand;\nit's a cleaner and more sophisticated amd(8).  When an automounted\nfilesystem is accessed, the kernel tells the daemon via an RPC to\nactually mount the filesystem from its real server, and the daemon\ngoes on to complete the mount.  Unfortunately, users can also tell\nthe daemon to do things.\n\nMy previous Solaris-specific example sent a legal message to the\ndaemon, telling it to mount some bogus path and use a configuration\nmap *I* supply to resolve the request.  This message is forged only\nin the sense the daemon blindly believes it came from the kernel.\nThe Solaris automountd has a feature in which if a map has the\nexecute bit on, it will execute the map instead of opening it for\nparsing, and then read the output of the executed map.  This is a\nvery useful feature, however as demonstrated it is trivialy abused\nto cause the daemon to run any command.  Since the get-root script\nautomountd ran didn't return any valid output, you can see the\ndaemon failed to perform the bogus mount.\n\njoplin> mount woop /tmp/auto_hack woop woop\nmount: No such file or directory",
  "ID": "VU#18833",
  "IDNumber": "18833",
  "IPProtocol": "",
  "Impact": "Local users can get root",
  "Keywords": [
    "autofs",
    "automountd",
    "autofsd",
    "RPC",
    "Solaris",
    "SGI. Irix",
    "IBM AIX",
    "root compromise"
  ],
  "Overview": "",
  "References": [
    "http://www.netspace.org/cgi-bin/wa?A2=ind9711d&L=bugtraq&F=&S=&P=2764",
    "http://www.netspace.org/cgi-bin/wa?A2=ind9810c&L=bugtraq&F=&S=&P=2446",
    "http://www.netspace.org/cgi-bin/wa?A2=ind9810d&L=bugtraq&F=&S=&P=1361",
    "http://www.netspace.org/cgi-bin/wa?A2=ind9810d&L=bugtraq&F=&S=&P=5060",
    "http://www-1.ibm.com/services/brs/brspwhub.nsf/advisories/852567CC004F9038852566BF007B6393/$file/ERS-SVA-E01-1998_004_1.txt",
    "[OLD]http://www.brs.ibm.com/services/brs/ers/brspwadv.nsf/Date/8AD9BB5A313ADE3C852566BF007B6393/$file/ERS-SVA-E01-1998_004_1.txt",
    "ftp://sgigate.sgi.com/security/19981005-01-PX"
  ],
  "Resolution": "",
  "Revision": 3,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "autofsd/automountd fails to validate that maps are genuine in an exec of an executable map",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}