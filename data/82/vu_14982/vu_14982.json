{
  "Author": "This document was written by Shawn V Hernan.",
  "CAM_AttackerAccessRequired": "20",
  "CAM_EaseOfExploitation": "1",
  "CAM_Exploitation": "10",
  "CAM_Impact": "20",
  "CAM_InternetInfrastructure": "5",
  "CAM_Population": "15",
  "CAM_ScoreCurrent": 1.8,
  "CAM_ScoreCurrentWidelyKnown": 3.9375,
  "CAM_ScoreCurrentWidelyKnownExploited": 5.0625,
  "CAM_WidelyKnown": "1",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:56:12-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "1998-05-21T11:56:15-04:00",
  "DatePublic": "",
  "Description": "Transarc's instructions for setting up Solaris 2.6 to use the AFS PAM\n(Pluggable Authentication Module) uncovers/yields a serious security\nproblem whereby anyone can enter a valid username, followed by an\narbitrary string, to gain access to a system (including root).\n\nThe problem occurs when one follows Transarc's instructions and\nconverts all of the authentication services in /etc/pam.conf from\n'required' to 'optional'.  In theory, this should work okay, because\nat least one of the optional services would have to return a 'success'\nin order to give access.  However, because pam_dial_auth, always\nreturns a 'success', none of the other services need to return a\n'success' and any user can gain access.\n\nThe pam_dial_auth documentation (man page) indicates that it only\nperforms authentication if the /etc/dialups and /etc/d_passwd files\nexist, but the documentation does not indicate that pam_dial_auth\ndoes not return an error if either or both of these files are missing.\n\nThe problem here is that pam_dial_auth's reluctance to return an error\nstatus, coupled with reliance on PAM's behavior when all auth\nfacilities are configured 'optional', results in unintended access.\n\n... from pam.conf man page:\n\nIf none of the service modules in the stack  are  designated\nas  requisite  or  required, then the PAM framework requires\nthat at least one optional or sufficient module succeed.  If\nall  fail then the error value from the first service module\nin the stack is returned.\n\nSo, pam_dial_auth's \"success\" is enough to grant access. Any product\nattempting to modify the PAM framework which gives the questionable\nadvice of changing all PAM controls to 'optional' would cause similar\nbehavior (i.e. not specifically a Transarc problem).",
  "ID": "VU#14982",
  "IDNumber": "14982",
  "IPProtocol": "",
  "Impact": "Anyone can enter a valid username followed by an arbitrary string\nto gain access to a system (including root access).",
  "Keywords": [
    "afs",
    "pam",
    "authentication",
    "pluggable authentication module",
    "transarc"
  ],
  "Overview": "",
  "References": "http://www.transarc.com/Support/afs/news/pam.html",
  "Resolution": "",
  "Revision": "1",
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "transarc_pam_configuration",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": "With this configuration, login        auth sufficient /usr/lib/security/pam_afs.so.1 try_first_pass\nignore_root setenv_password_expires\nlogin        auth required   /usr/lib/security/pam_unix.so.1\nlogin        auth required   /usr/lib/security/pam_dial_auth.so.1 bogus password as root doesn't succeed, and users are prompted for SYSTEM\npassword iff failed to provide proper AFS password. So far, this is\nclosest to something reasonable."
}