{
  "Author": "This document was written by CN=Rob D McMillan/O=CERT.",
  "CAM_AttackerAccessRequired": "10",
  "CAM_EaseOfExploitation": "5",
  "CAM_Exploitation": "15",
  "CAM_Impact": "8",
  "CAM_InternetInfrastructure": "8",
  "CAM_Population": "8",
  "CAM_ScoreCurrent": 2.22,
  "CAM_ScoreCurrentWidelyKnown": 2.58,
  "CAM_ScoreCurrentWidelyKnownExploited": 2.88,
  "CAM_WidelyKnown": "14",
  "CERTAdvisory": "CA-1997-14",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "",
  "CVSS_AccessVector": "",
  "CVSS_Authenication": "",
  "CVSS_AvailabilityImpact": "",
  "CVSS_BaseScore": "",
  "CVSS_BaseVector": "",
  "CVSS_CollateralDamagePotential": "",
  "CVSS_ConfidentialityImpact": "",
  "CVSS_EnvironmentalScore": "",
  "CVSS_EnvironmentalVector": "",
  "CVSS_Exploitability": "",
  "CVSS_IntegrityImpact": "",
  "CVSS_RemediationLevel": "",
  "CVSS_ReportConfidence": "",
  "CVSS_SecurityRequirementsAR": "",
  "CVSS_SecurityRequirementsCR": "",
  "CVSS_SecurityRequirementsIR": "",
  "CVSS_TargetDistribution": "",
  "CVSS_TemporalScore": "",
  "CVSS_TemporalVector": "",
  "DateCreated": "1998-05-21T11:47:21-04:00",
  "DateFirstPublished": "",
  "DateLastUpdated": "2004-02-19T16:23:00-05:00",
  "DatePublic": "",
  "Description": "Reduced to its simplest terms, in csh you can give the following\ncommand:\n\n(39) $ /bin/csh\n(1) % set x=rdm y=georgia\n(2) % set\n{...}\nx       rdm\ny       georgia\n\nThat is, multiple shell variables can be set with one \"set\"\ncommand. This can be done likewise with sh:\n\n% x=rdm y=georgia\n% echo $x\nrdm\n% echo $y\ngeorgia\n\nPresumably its also true of tcsh.\n\nThe problem in this vul is that the showexternal and showpartial\nscripts that metamail use will similarly interpret parameters, as\nthey do not include quotes where necessary.\n\nThe reporter writes:\n\nAt least tcsh, and possily a few other csh's, do seem to do\nweird things when expanding command line arguments.\n\nIf you give a script an argument of \"foo FTP=/tmp/evilcmd\",\nand it does\n\nset var=$1\n\nthis will assign foo to $var, and /tmp/evilcmd to\n$FTP. Unfortunately, metamail invokes showext with the mime\nattributes on the command line, so you basically send it a\nheader like this:\n\nContent-type:  message/external-body;\naccess-type=\"anon-ftp\";\nname=\"passwd\";\nsite=\"monad.swb.de\";\ndirectory=\"/etc\";\nmode=\"image FTP=/tmp/evilcmd\"\n\nThe variable \"FTP\" appears to be of some specific importance to\nmetamail.\n\n(jte adds) The FTP command is actually run with a \"-n\" option and\ninput that is largely (except for the first word of each line)\nunder the attacker's control.\n\nA shell script exploit would thus be easy (set $FTP to \"/bin/sh\")\nexcept for the happenstance that a \"-n\" option to all the shells\nmeans do NOT execute commands!  Bummer.\n\nPerl accepts a \"-n\" argument meaning to run the given program over\neach line of input.  Unfortunately, since there are no other\ncommand line arguments, the input _is_ the program so when Perl\nruns the program there is no input so it exits without doing any of\nthe commands given.  Bummer.\n\nSed doesn't mind a \"-n\", in fact it will quiet the script which is\nnice, but it is hard to accomplish anything interesting inside sed.\n\nAwk doesn't mind \"-n\" either, but it wants the first word to be a\npattern, and the first word is going to be \"open\" - I see no way\naround it.  Howard may know a way around this.\n\nNroff is a possibililty - it likes \"-n\" and has a way to escape to\nthe shell, but nroff commands must start with a \".\" at the front of\na line.  Unless there is a way to get a newline passed in as\nmetamail processes things (which is a possibility), this won't\nwork.",
  "ID": "VU#8510",
  "IDNumber": "8510",
  "IPProtocol": "",
  "Impact": "A sender of a MIME encoded mail message can cause the receiver to\nexecute an arbitrary command with a single -n option. If the\nattacker has an account on the target user's local system, or if\nthe target user's system supports AFS or other distributed\nfilesystem, then the attacker can arrange for the arbitrary command\nto be one the attacker created.",
  "Keywords": [
    "metamail",
    "parameter expansion",
    "shell variables",
    "quotes"
  ],
  "Overview": "",
  "References": "",
  "Resolution": "",
  "Revision": 2,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "",
  "Title": "Metamail",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "",
  "VRDA_D1_Impact": "",
  "VRDA_D1_Population": "",
  "VulnerabilityCount": 1,
  "Workarounds": ""
}