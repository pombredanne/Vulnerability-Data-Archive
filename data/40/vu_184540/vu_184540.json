{
  "Author": "This document was written by Joel Land.",
  "CAM_AttackerAccessRequired": "0",
  "CAM_EaseOfExploitation": "0",
  "CAM_Exploitation": "0",
  "CAM_Impact": "0",
  "CAM_InternetInfrastructure": "0",
  "CAM_Population": "0",
  "CAM_ScoreCurrent": 0,
  "CAM_ScoreCurrentWidelyKnown": 0,
  "CAM_ScoreCurrentWidelyKnownExploited": 0,
  "CAM_WidelyKnown": "0",
  "CERTAdvisory": "",
  "CVEIDs": "",
  "CVSS_AccessComplexity": "L",
  "CVSS_AccessVector": "N",
  "CVSS_Authenication": "N",
  "CVSS_AvailabilityImpact": "P",
  "CVSS_BaseScore": 7.5,
  "CVSS_BaseVector": "AV:N/AC:L/Au:N/C:P/I:P/A:P",
  "CVSS_CollateralDamagePotential": "ND",
  "CVSS_ConfidentialityImpact": "P",
  "CVSS_EnvironmentalScore": 5.33281960358437,
  "CVSS_EnvironmentalVector": "CDP:ND/TD:M/CR:ND/IR:ND/AR:ND",
  "CVSS_Exploitability": "F",
  "CVSS_IntegrityImpact": "P",
  "CVSS_RemediationLevel": "U",
  "CVSS_ReportConfidence": "C",
  "CVSS_SecurityRequirementsAR": "ND",
  "CVSS_SecurityRequirementsCR": "ND",
  "CVSS_SecurityRequirementsIR": "ND",
  "CVSS_TargetDistribution": "M",
  "CVSS_TemporalScore": 7.1,
  "CVSS_TemporalVector": "E:F/RL:U/RC:C",
  "DateCreated": "2014-09-08T15:37:54-04:00",
  "DateFirstPublished": "2014-10-23T16:00:07-04:00",
  "DateLastUpdated": "2015-06-29T14:58:00-04:00",
  "DatePublic": "2014-10-21T00:00:00",
  "Description": "CWE-200: Information Exposure NAT-PMP is a port-mapping protocol in which a network address translation (NAT) device, typically a router, is petitioned by a trusted local network host to forward traffic between the external network and the petitioning host. As specified in RFC 6886, \"The NAT gateway MUST NOT accept mapping requests destined to the NAT gateway's external IP address or received on its external network interface.\" Additionally, mapping requests \"must\" be mapped to the source address of the internal requesting host. When a NAT-PMP device fails to enforce these restrictions and is unsafely configured, it may accept malicious port mapping requests or disclose information about itself. Rapid7's report describes the scope of the problem and the vulnerabilities that may emerge from incorrect configurations and implementations NAT-PMP: Vulnerability Summary During our research, we identified approximately 1.2 million devices on the public Internet that responded to our external NAT-PMP probes.\u00a0 Their responses represent two types of vulnerabilities; malicious port mapping manipulation and information disclosure about the NAT-PMP device.\u00a0 These can be broken down into 5 specific issues, outlined below: Interception of Internal NAT Traffic: ~30,000 (2.5% of responding devices)\nInterception of External Traffic: ~1.03m (86% of responding devices)\nAccess to Internal NAT Client Services: ~1.06m (88% of responding devices)\nDoS Against Host Services: ~1.06m (88% of responding devices)\nInformation Disclosure about the NAT-PMP device: ~1.2m (100% of responding devices) Rapid7 also indicates that incorrect configurations of miniupnpd are the likely culprit for most vulnerable instances. Miniupnpd is a light-weight UPnP daemon that also supports NAT-PMP and is widely available on all major platforms. It is possible for the internal and external network interfaces in miniupnpd to be interchangeably configured by implementers, which may explain how some devices are vulnerable. Additional details may be found in the advisory from Rapid7.",
  "ID": "VU#184540",
  "IDNumber": "184540",
  "IPProtocol": "",
  "Impact": "A remote, unauthenticated attacker may be able to gather information about a NAT device, manipulate its port mapping, intercept its private and public traffic, access its private client services, and block its host services.",
  "Keywords": [
    "nat-pmp",
    "miniupnpd",
    "cwe-200"
  ],
  "Overview": "Many NAT-PMP devices are incorrectly configured, allowing them to field requests received on external network interfaces or map forwarding routes to addresses other than that of the requesting host, making them potentially vulnerable to information disclosure and malicious port mapping requests.",
  "References": [
    "https://community.rapid7.com/community/metasploit/blog/2014/10/21/r7-2014-17-nat-pmp-implementation-and-configuration-vulnerabilities",
    "https://tools.ietf.org/html/rfc6886",
    "http://miniupnp.free.fr/",
    "https://github.com/miniupnp/miniupnp/commit/16389fda3c5313bffc83fb6594f5bb5872e37e5e",
    "https://github.com/miniupnp/miniupnp/commit/82604ec5d0a12e87cb5326ac2a34acda9f83e837"
  ],
  "Resolution": "Configure NAT-PMP Securely Developers and administrators implementing NAT-PMP should exercise care to ensure that devices are configured securely, specifically that the LAN and WAN interfaces are correctly assigned,\nNAT-PMP requests are only accepted on internal interfaces, and\nport mappings are only opened for the requesting internal IP address. Update miniupnpd Although the NAT-PMP vulnerabilities are not due to flaws in miniupnpd's code, an update has been released that more strictly enforces RFC 6886. As of version 1.8.20141022, miniupnpd discards NAT-PMP packets received on the WAN interface. The default configuration file, miniupnpd.conf, now contains additional comments to encourage more secure configurations.",
  "Revision": 39,
  "SystemsAffectedPreamble": "",
  "ThanksAndCredit": "Thanks to Tod Beardsley and Jon Hart of Rapid7, Inc, for reporting this vulnerability. Thanks to Thomas Bernard of the MiniUPnP project for his assistance in the coordination and remediation effort.",
  "Title": "Incorrect implementation of NAT-PMP in multiple devices",
  "US-CERTTechnicalAlert": "",
  "VRDA_D1_DirectReport": "1",
  "VRDA_D1_Impact": "3",
  "VRDA_D1_Population": "3",
  "VulnerabilityCount": 2,
  "Workarounds": "Restrict Access Deploy firewall rules to block untrusted hosts from being able to access port 5351/udp. Disable NAT-PMP Consider disabling NAT-PMP on the device if it is not absolutely necessary."
}